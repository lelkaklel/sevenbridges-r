<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Complete Guide for Seven Bridges API R Client • sevenbridges</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Complete Guide for Seven Bridges API R Client">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google analytics --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-87185344-1', 'auto');
  ga('send', 'pageview');

</script>
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">sevenbridges-r</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/api.html">Complete Guide for Seven Bridges API R Client</a>
    </li>
    <li>
      <a href="../articles/apps.html">Describe and Execute CWL Tools/Workflows in R</a>
    </li>
    <li>
      <a href="../articles/bioc-workflow.html">Master Tutorial: Use R for Cancer Genomics Cloud</a>
    </li>
    <li>
      <a href="../articles/cgc-sparql.html">Find Data on CGC via Data Exploerer, SPARQL, and Datasets API</a>
    </li>
    <li>
      <a href="../articles/docker.html">Creating Your Docker Container and Command Line Interface (with docopt)</a>
    </li>
    <li>
      <a href="../articles/rstudio.html">IDE Container: RStudio Server, Shiny Server, and More</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sbg/sevenbridges-r">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Complete Guide for Seven Bridges API R Client</h1>
                        <h4 class="author">Tengfei Yin &lt;<a href="mailto:tengfei.yin@sevenbridges.com">tengfei.yin@sevenbridges.com</a>&gt; <br> Nan Xiao &lt;<a href="mailto:nan.xiao@sevenbridges.com">nan.xiao@sevenbridges.com</a>&gt;</h4>
            
            <h4 class="date">2018-02-23</h4>
          </div>

    
    
<div class="contents">
<p><a name="top"></a></p>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p><code>sevenbridges</code> is an R/Bioconductor package that provides an interface for Seven Bridges public API. The supported platforms includes the <a href="https://igor.sbgenomics.com/">Seven Bridges Platform</a>, <a href="https://www.cancergenomicscloud.org">Cancer Genomics Cloud (CGC)</a>, and <a href="https://cavatica.sbgenomics.com">Cavatica</a>.</p>
<p>Learn more from our documentation on the <a href="https://docs.sevenbridges.com/page/api">Seven Bridges Platform</a> and the <a href="http://docs.cancergenomicscloud.org/v1.0/page/the-cgc-api">Cancer Genomics Cloud (CGC)</a>.</p>
<div align="right">
<a href="#top">top</a>
</div>
<div id="r-client-for-seven-bridges-api" class="section level2">
<h2 class="hasAnchor">
<a href="#r-client-for-seven-bridges-api" class="anchor"></a>R Client for Seven Bridges API</h2>
<p>The <code>sevenbridges</code> package only supports v2+ versions of the API, since versions prior to V2 are not compatible with the Common Workflow Language (CWL). This package provides a simple interface for accessing and trying out various methods.</p>
<p>There are two ways of constructing API calls. For instance, you can use low-level API calls which use arguments like <code>path</code>, <code>query</code>, and <code>body</code>. These are documented in the API reference libraries for the <a href="https://docs.sevenbridges.com/reference#list-all-api-paths">Seven Bridges Platform</a> and the <a href="http://docs.cancergenomicscloud.org/docs/new-1">CGC</a>. An example of a low-level request to “list all projects” is shown below. In this request, you can also pass <code>query</code> and <code>body</code> as a list.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"sevenbridges"</span>)
a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">token =</span> <span class="st">"8c3329a4de664c35bb657499bb2f335c"</span>,
          <span class="dt">platform =</span> <span class="st">"aws-us"</span>)
a<span class="op">$</span><span class="kw"><a href="../reference/api.html">api</a></span>(<span class="dt">path =</span> <span class="st">"projects"</span>, <span class="dt">method =</span> <span class="st">"GET"</span>)</code></pre></div>
<p><strong><em>(Advanced user option)</em></strong> The second way of constructing an API request is to directly use the <code>httr</code> package to make your API calls, as shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">project</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="api-general-information" class="section level2">
<h2 class="hasAnchor">
<a href="#api-general-information" class="anchor"></a>API General Information</h2>
<p>Before we start, keep in mind the following:</p>
<p><strong><code>offset</code> and <code>limit</code></strong></p>
Every API call accept arguments called <code>offset</code> and <code>limit</code>.
<ul>
<li>
Offset defines where the retrieved items started.
</li>
<li>
Limit defines the quantity of items you want to get.
</li>
</ul>
<p>By default, <code>offset</code> is set to <code>0</code> and <code>limit</code> is set to <code>100</code>. As such, your API request returns the <strong>first 100 items</strong> when you list items or search for items by name. To search and list all items, use <code>complete = TRUE</code> in your API request.</p>
<p><strong>Search by ID</strong></p>
<p>When searching by ID, your request will return your exact resource as it is unique. As such, you do not have to manually set <code>offset</code> and <code>limit</code>. It is a good practice to find your resources by their ID and pass this ID as an input to your task. You can find a resource’s ID in the final part of the URL on the visual interface or via the API requests to list resources or get a resource’s details.</p>
<p><strong>Search by name</strong></p>
<p>Search by name returns all partial matches unless you specify <code>exact = TRUE</code>.  </p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>The <code>sevenbridges</code> package is on both the Bioconductor released and devel branches, as shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># try http:// if https:// URLs are not supported</span>
<span class="kw">source</span>(<span class="st">"https://bioconductor.org/biocLite.R"</span>)
<span class="kw">biocLite</span>(<span class="st">"sevenbridges"</span>)</code></pre></div>
<p>Since we are constantly improving our API and client libraries, please also visit our <a href="https://github.com/sbg/sevenbridges-r">GitHub repository</a> for most recent news and for latest version of the package.</p>
<div align="right">
<a href="#top">top</a>
</div>
<p><strong>If you do not have <code>devtools</code></strong></p>
<p>This installation requires that you have the <code>devtools</code> package. If you do not have this package, you can install it from <a href="https://cran.r-project.org/package=devtools">CRAN</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"devtools"</span>)</code></pre></div>
<p>You may got an error and need system dependecies for curl and ssl. For example, in Ubuntu you probably need to do the following first in order to install <code>devtools</code> and in order to build vignettes since you need <code>pandoc</code>.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">apt-get</span> update
<span class="ex">apt-get</span> install libcurl4-gnutls-dev libssl-dev pandoc pandoc-citeproc</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
<p><strong>If <code>devtools</code> is already installed</strong></p>
<p>Install the latest version for <code>sevenbridges</code> from GitHub with the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">"https://bioconductor.org/biocLite.R"</span>)
<span class="kw">biocLite</span>(<span class="st">"readr"</span>)

devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"sbg/sevenbridges-r"</span>, <span class="dt">build_vignettes =</span> <span class="ot">TRUE</span>,
  <span class="dt">repos =</span> BiocInstaller<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/BiocInstaller/topics/biocinstallRepos">biocinstallRepos</a></span>(),
  <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>If you have trouble with <code>pandoc</code> and do not want to install it, set <code>build_vignettes = FALSE</code> to avoid the vignettes build.</p>
</div>
</div>
<div id="quickstart" class="section level1">
<h1 class="hasAnchor">
<a href="#quickstart" class="anchor"></a>Quickstart</h1>
<p>For more details about how to use the API client in R, please consult the <a href="#reference">Seven Bridges API Reference</a> section below for a complete guide. This section is a Quickstart which walks through the basics of using the R cliet libary to help you get started.</p>
<div id="create-auth-object" class="section level2">
<h2 class="hasAnchor">
<a href="#create-auth-object" class="anchor"></a>Create <code>Auth</code> Object</h2>
<p>Before you can access your account via the API, you have to provide your credentials. You can obtain your credentials in the form of an <a href="https://docs.sevenbridges.com/v1.0/docs/get-your-authentication-token">“authentication token”</a> from the <strong>Developer Tab</strong> under <strong>Account Settings</strong> on the visual interface. Once you’ve obtained this, create an <code>Auth</code> object so it remembers your authentication token and the path for the API. All subsequent requests will draw upon these two pieces of information.</p>
<p>Let’s load the package first:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"sevenbridges"</span>)</code></pre></div>
<p>You have three different ways to provide your token. Choose from one method below:</p>
<ol style="list-style-type: decimal">
<li>
<a href="#method1">Direct authentication.</a> This explicitly and temporarily sets up your token and platform type (or alternatively, API base url) in the function call arguments to <code><a href="../reference/Auth-class.html">Auth()</a></code>.</li>
<li>
<a href="#method2">Authentication via system environment variables.</a> This will read the credential information from two system environment variables: <code>SB_API_ENDPOINT</code> and <code>SB_AUTH_TOKEN</code>.</li>
<li>
<a href="#method3">Authentication via user configuration file.</a> This file, by default <code>$HOME/.sevenbridges/credentials</code>, provides an organized way to collect and manage all your API authentication information for Seven Bridges platforms.</li>
</ol>
<div style="margin-left:3em">
<p><a name="method1"></a><strong>Method 1: Direct authentication</strong></p>
<p>This is the most common method to construct the <code>Auth</code> object. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">platform =</span> <span class="st">"cgc"</span>, <span class="dt">token =</span> <span class="st">"your_token"</span>))</code></pre></div>
<pre><code>Using platform: cgc
== Auth ==
url : https://cgc-api.sbgenomics.com/v2/
token : &lt;your_token&gt;</code></pre>
<p><a name="method2"></a><strong>Method 2: Environment variables</strong></p>
<p>To set the two environment variables in your system, you could use the function <code><a href="../reference/sbg_set_env.html">sbg_set_env()</a></code>. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/sbg_set_env.html">sbg_set_env</a></span>(<span class="st">"https://cgc-api.sbgenomics.com/v2"</span>, <span class="st">"your_token"</span>)</code></pre></div>
<p>Note that this change might be just temporary, please feel free to use the standard method to set persistent environment variables according to your operation system.</p>
<p>Create an <code>Auth</code> object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">from =</span> <span class="st">"env"</span>)</code></pre></div>
<p><a name="method3"></a><strong><em>Method 3: User configuration file</em></strong></p>
<p>Assume we have already created the configuration file named <code>credentials</code> under the directory <code>$HOME/.sevenbridges/</code>:</p>
<pre><code>[aws-us-tengfei]
api_endpoint = https://api.sbgenomics.com/v2
auth_token = token_for_this_user

# This is a comment:
# another user on the same platform
[aws-us-yintengfei]
api_endpoint = https://api.sbgenomics.com/v2
auth_token = token_for_this_user

[default]
api_endpoint = https://cgc-api.sbgenomics.com/v2
auth_token = token_for_this_user

[gcp]
api_endpoint = https://gcp-api.sbgenomics.com/v2
auth_token = token_for_this_user</code></pre>
<p>To load the user profile <code>aws-us-tengfei</code> from this configuration file, simply use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">from =</span> <span class="st">"file"</span>, <span class="dt">profile_name =</span> <span class="st">"aws-us-tengfei"</span>)</code></pre></div>
<p>If <code>profile_name</code> is not specified, we will try to load the profile named <code>[default]</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">from =</span> <span class="st">"file"</span>)</code></pre></div>
<p><strong><em>Note:</em></strong> API paths (base URLs) differ for each Seven Bridges environment. Be sure to provide the correct path for the environment you are using. API paths for some of the environments are as follows:</p>
<table class="table">
<colgroup>
<col width="48%">
<col width="37%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th>Platform</th>
<th>API Base URL</th>
<th>Platform Name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><p>Cancer Genomics Cloud (CGC)</p></td>
<td><p><code>https://cgc-api.sbgenomics.com/v2</code></p></td>
<td><p><code>"cgc"</code></p></td>
</tr>
<tr class="even">
<td><p>Seven Bridges Platform on Amazon Web Services (US)</p></td>
<td><p><code>https://api.sbgenomics.com/v2</code></p></td>
<td><p><code>"aws-us"</code></p></td>
</tr>
<tr class="odd">
<td><p>Seven Bridges Platform on Amazon Web Services (EU)</p></td>
<td><p><code>https://eu-api.sbgenomics.com/v2</code></p></td>
<td><p><code>"aws-eu"</code></p></td>
</tr>
<tr class="even">
<td><p>Seven Bridges Platform on Google Cloud Platform (GCP)</p></td>
<td><p><code>https://gcp-api.sbgenomics.com/v2</code></p></td>
<td><p><code>"gcp"</code></p></td>
</tr>
<tr class="odd">
<td><p>Cavatica</p></td>
<td><p><code>https://cavatica-api.sbgenomics.com/v2</code></p></td>
<td><p><code>"cavatica"</code></p></td>
</tr>
</tbody>
</table>
<p>Please refer to the <a href="#auth-reference">API reference section</a> for more usage and technical details about the three authentication methods.</p>
</div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="get-user-information" class="section level2">
<h2 class="hasAnchor">
<a href="#get-user-information" class="anchor"></a>Get User Information</h2>
<p><a name="youruser"></a><strong>Get your own information</strong></p>
<p>This call returns information about your account.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">user</span>()</code></pre></div>
<pre><code>== User ==
href : https://cgc-api.sbgenomics.com/v2/users/tengfei
username : tengfei
email : tengfei.yin@sevenbridges.com
first_name : Tengfei
last_name : Yin
affiliation : Seven Bridges Genomics
country : United States</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
<p><strong>Get information about a user</strong></p>
<p>This call returns information about the specified user. Note that currently you can view only your own user information, so this call is equivalent to the <a href="#youruser">call to get information about your account</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">user</span>(<span class="dt">username =</span> <span class="st">"tengfei"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="rate-limit" class="section level2">
<h2 class="hasAnchor">
<a href="#rate-limit" class="anchor"></a>Rate Limit</h2>
<p>This call returns information about your current rate limit. This is the number of API calls you can make in one hour.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">rate_limit</span>()</code></pre></div>
<pre><code>== Rate Limit ==
limit : 1000
remaining : 993
reset : 1457980957</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="show-billing-information" class="section level2">
<h2 class="hasAnchor">
<a href="#show-billing-information" class="anchor"></a>Show Billing Information</h2>
<p>Each project must have a Billing Group associated with it. This Billing Group pays for the storage and computation in the project.</p>
<p>For example, your first project(s) were created with the free funds from the Pilot Funds Billing Group assigned to each user at sign-up. To get information about billing:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># check your billing info</span>
a<span class="op">$</span><span class="kw">billing</span>()
a<span class="op">$</span><span class="kw">invoice</span>()</code></pre></div>
<p>For more information, use <code>breakdown = TRUE</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">billing</span>(<span class="dt">id =</span> <span class="st">"your_billing_id"</span>, <span class="dt">breakdown =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="create-project" class="section level2">
<h2 class="hasAnchor">
<a href="#create-project" class="anchor"></a>Create Project</h2>
<p>Projects are the core building blocks of the platform. Each project corresponds to a distinct scientific investigation, serving as a container for its data, analysis tools, results, and team of collaborators.</p>
<p>Create a new project called “api testing” with the billing group <code>id</code> obtained above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get billing group id</span>
bid &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">billing</span>()<span class="op">$</span>id
<span class="co"># create new project</span>
(p &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">project_new</span>(<span class="dt">name =</span> <span class="st">"api testing"</span>, bid, <span class="dt">description =</span> <span class="st">"Just a test"</span>))</code></pre></div>
<pre><code>== Project ==
id : tengfei/api-testing
name : api testing
description : Just a test
billing_group_id : &lt;fake_bid&gt;
type : v2
-- Permission --</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="get-details-about-existing-project" class="section level2">
<h2 class="hasAnchor">
<a href="#get-details-about-existing-project" class="anchor"></a>Get Details about Existing Project</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># list first 100</span>
a<span class="op">$</span><span class="kw">project</span>()
<span class="co"># list all</span>
a<span class="op">$</span><span class="kw">project</span>(<span class="dt">complete =</span> <span class="ot">TRUE</span>)
<span class="co"># return all named match "demo"</span>
a<span class="op">$</span><span class="kw">project</span>(<span class="dt">name =</span> <span class="st">"demo"</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)
<span class="co"># get the project you want by id</span>
p &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/api-tutorial"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="copy-public-apps-into-your-project" class="section level2">
<h2 class="hasAnchor">
<a href="#copy-public-apps-into-your-project" class="anchor"></a>Copy Public Apps into Your Project</h2>
<p>Seven Bridges maintains workflows and tools available to all of its users in the Public Apps repository.</p>
<p>To find out more about public apps, you can do the following:</p>
<ul>
<li>Browse them online. Check out the <a href="http://docs.cancergenomicscloud.org/docs/">tutorial</a> for the “Find apps” section.</li>
<li>You can use the <code>sevenbridges</code> package to find it, as shown below.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># search by name matching, complete = TRUE search all apps,</span>
<span class="co"># not limited by offset or limit.</span>
a<span class="op">$</span><span class="kw">public_app</span>(<span class="dt">name =</span> <span class="st">"STAR"</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)
<span class="co"># search by id is accurate</span>
a<span class="op">$</span><span class="kw">public_app</span>(<span class="dt">id =</span> <span class="st">"admin/sbg-public-data/rna-seq-alignment-star/5"</span>)
<span class="co"># you can also get everything</span>
a<span class="op">$</span><span class="kw">public_app</span>(<span class="dt">complete =</span> <span class="ot">TRUE</span>)
<span class="co"># default limit = 100, offset = 0 which means the first 100</span>
a<span class="op">$</span><span class="kw">public_app</span>()</code></pre></div>
<p>Now, from your <code>Auth</code> object, you copy an App <code>id</code> into your <code>project</code> id with a new <code>name</code>, following this logic.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># copy</span>
a<span class="op">$</span><span class="kw">copy_app</span>(<span class="dt">id =</span> <span class="st">"admin/sbg-public-data/rna-seq-alignment-star/5"</span>,
           <span class="dt">project =</span> <span class="st">"tengfei/api-testing"</span>, <span class="dt">name =</span> <span class="st">"new copy of star"</span>)
<span class="co"># check if it is copied</span>
p &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/api-testing"</span>)
<span class="co"># list apps your got in your project</span>
p<span class="op">$</span><span class="kw">app</span>()</code></pre></div>
<p>The short name is changed to <code>newcopyofstar</code>.</p>
<pre><code>== App ==
id : tengfei/api-testing/newcopyofstar/0
name : RNA-seq Alignment - STAR
project : tengfei/api-testing-2
revision : 0</code></pre>
<p>Alternatively, you can copy it from the <code>app</code> object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">app &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">public_app</span>(<span class="dt">id =</span> <span class="st">"admin/sbg-public-data/rna-seq-alignment-star"</span>)
app<span class="op">$</span><span class="kw">copy_to</span>(<span class="dt">project =</span> <span class="st">"tengfei/api-testing"</span>,
            <span class="dt">name =</span> <span class="st">"copy of star"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="import-cwl-app-and-run-a-task" class="section level2">
<h2 class="hasAnchor">
<a href="#import-cwl-app-and-run-a-task" class="anchor"></a>Import CWL App and Run a Task</h2>
<p>You can also upload your own Common Workflow Language JSON file which describes your app to your project.</p>
<p><strong><em>Note:</em></strong> Alternatively, you can directly describe your CWL tool in R with this package. Please read the vignette on “Describe CWL Tools/Workflows in R and Execution”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># add an CWL file to your project</span>
f.star &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata/app"</span>, <span class="st">"flow_star.json"</span>, <span class="dt">package =</span> <span class="st">"sevenbridges"</span>)
app &lt;-<span class="st"> </span>p<span class="op">$</span><span class="kw">app_add</span>(<span class="st">"starlocal"</span>, fl.runif)
(aid &lt;-<span class="st"> </span>app<span class="op">$</span>id)</code></pre></div>
<p>You will get an app <code>id</code>, like the one below:</p>
<pre><code>"tengfei/api-testing/starlocal/0"</code></pre>
<p>It’s composed of the following elements:</p>
<ol style="list-style-type: decimal">
<li>
<strong>project id</strong> : <code>tengfei/api</code>
</li>
<li>
<strong>app short name</strong> : <code>runif</code>
</li>
<li>
<strong>revision</strong> : <code>0</code>
</li>
</ol>
<p>Alternatively, you can describe tools in R directly, as shown below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fl &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"docker"</span>, <span class="st">"sevenbridges/rabix/generator.R"</span>,
                  <span class="dt">package =</span> <span class="st">"sevenbridges"</span>)
<span class="kw">cat</span>(<span class="kw">readLines</span>(fl), <span class="dt">sep =</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</code></pre></div>
<pre><code>library("sevenbridges")

in.lst &lt;- list(
    input(id = "number",
          description = "number of observations",
          type = "integer",
          label = "number",
          prefix = "--n",
          default = 1,
          required = TRUE,
          cmdInclude = TRUE),
    input(id = "min",
          description = "lower limits of the distribution",
          type = "float",
          label = "min",
          prefix = "--min",
          default = 0),
    input(id = "max",
          description = "upper limits of the distribution",
          type = "float",
          label = "max",
          prefix = "--max",
          default = 1),
    input(id = "seed",
          description = "seed with set.seed",
          type = "float",
          label = "seed",
          prefix = "--seed",
          default = 1))

# the same method for outputs
out.lst &lt;- list(
    output(id = "random",
           type = "file",
           label = "output",
           description = "random number file",
           glob = "*.txt"),
    output(id = "report",
           type = "file",
           label = "report",
           glob = "*.html"))

rbx &lt;- Tool(
    id = "runif",
    label = "Random number generator",
    hints = requirements(docker(pull = "tengfei/runif"), cpu(1), mem(2000)),
    baseCommand = "runif.R",
    inputs = in.lst,  # or ins.df
    outputs = out.lst)

fl &lt;- "inst/docker/sevenbridges/rabix/runif.json"
write(rbx$toJSON(pretty = TRUE), fl)</code></pre>
<p>Then, you can add it like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># rbx is the object returned by `Tool` function</span>
app &lt;-<span class="st"> </span>p<span class="op">$</span><span class="kw">app_add</span>(<span class="st">"runif"</span>, rbx)
(aid &lt;-<span class="st"> </span>app<span class="op">$</span>id)</code></pre></div>
<p>Please consult another tutorial <code><a href="../articles/apps.html">vignette("apps", "sevenbridges")</a></code> about how to describe tools and flows in R.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="execute-a-new-task" class="section level2">
<h2 class="hasAnchor">
<a href="#execute-a-new-task" class="anchor"></a>Execute a New Task</h2>
<div id="find-your-app-inputs" class="section level3">
<h3 class="hasAnchor">
<a href="#find-your-app-inputs" class="anchor"></a>Find your app inputs</h3>
<p>Once you have copied the public app <code>admin/sbg-public-data/rna-seq-alignment-star/5</code> into your project, <code>username/api-testing</code>, the app <code>id</code> in your current project is <code>username/api-testing/newcopyofstar</code>. Conversely, you can use another app you already have in your project for this Quickstart.</p>
<p>To draft a new task, you need to specify the following:</p>
<ul>
<li>The name of the task</li>
<li>An optional description</li>
<li>The app <code>id</code> of the workflow you are executing</li>
<li>The inputs for your workflow. In this case, the CWL app accepts four parameters: number, min, max, and seed.</li>
</ul>
<p>You can always check the App details on the visual interface for task input requirements. To find the required inputs with R, you need to get an <code>App</code> object first.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">app &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">app</span>(<span class="dt">id =</span> <span class="st">"tengfei/api-testing-2/newcopyofstar"</span>)
<span class="co"># get input matrix</span>
app<span class="op">$</span><span class="kw"><a href="../reference/input_output_matrix.html">input_matrix</a></span>()
app<span class="op">$</span><span class="kw"><a href="../reference/input_output_matrix.html">input_matrix</a></span>(<span class="kw">c</span>(<span class="st">"id"</span>, <span class="st">"label"</span>, <span class="st">"type"</span>))
<span class="co"># get required node only</span>
app<span class="op">$</span><span class="kw"><a href="../reference/input_output_matrix.html">input_matrix</a></span>(<span class="kw">c</span>(<span class="st">"id"</span>, <span class="st">"label"</span>, <span class="st">"type"</span>), <span class="dt">required =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Conversely, you can load the app from a CWL JSON and convert it into an R object first, as shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f1 &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata/app"</span>, <span class="st">"flow_star.json"</span>, <span class="dt">package =</span> <span class="st">"sevenbridges"</span>)
app &lt;-<span class="st"> </span><span class="kw"><a href="../reference/convert_app.html">convert_app</a></span>(f1)
<span class="co"># get input matrix</span>
app<span class="op">$</span><span class="kw"><a href="../reference/input_output_matrix.html">input_matrix</a></span>()</code></pre></div>
<pre><code>##                                id                    label    type
## 1                    #sjdbGTFfile              sjdbGTFfile File...
## 2                          #fastq                    fastq File...
## 3               #genomeFastaFiles         genomeFastaFiles    File
## 4 #sjdbGTFtagExonParentTranscript      Exons' parents name  string
## 5       #sjdbGTFtagExonParentGene                Gene name  string
## 6          #winAnchorMultimapNmax         Max loci anchors     int
## 7             #winAnchorDistNbins Max bins between anchors     int
##   required fileTypes
## 1    FALSE      null
## 2     TRUE      null
## 3     TRUE      null
## 4    FALSE      null
## 5    FALSE      null
## 6    FALSE      null
## 7    FALSE      null</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">app<span class="op">$</span><span class="kw"><a href="../reference/input_output_matrix.html">input_matrix</a></span>(<span class="kw">c</span>(<span class="st">"id"</span>, <span class="st">"label"</span>, <span class="st">"type"</span>))</code></pre></div>
<pre><code>##                                id                    label    type
## 1                    #sjdbGTFfile              sjdbGTFfile File...
## 2                          #fastq                    fastq File...
## 3               #genomeFastaFiles         genomeFastaFiles    File
## 4 #sjdbGTFtagExonParentTranscript      Exons' parents name  string
## 5       #sjdbGTFtagExonParentGene                Gene name  string
## 6          #winAnchorMultimapNmax         Max loci anchors     int
## 7             #winAnchorDistNbins Max bins between anchors     int</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">app<span class="op">$</span><span class="kw"><a href="../reference/input_output_matrix.html">input_matrix</a></span>(<span class="kw">c</span>(<span class="st">"id"</span>, <span class="st">"label"</span>, <span class="st">"type"</span>), <span class="dt">required =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>##                  id            label    type
## 2            #fastq            fastq File...
## 3 #genomeFastaFiles genomeFastaFiles    File</code></pre>
<p>Note <code>input_matrix</code> and <code>output_matrix</code> are useful accessor for <code>Tool</code>, <code>Flow</code>, <code>App</code> object as shown below in App example, you can directly call these two function on a JSON file as well.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tool.in =<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata/app"</span>, <span class="st">"tool_unpack_fastq.json"</span>, <span class="dt">package =</span> <span class="st">"sevenbridges"</span>)
flow.in =<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata/app"</span>, <span class="st">"flow_star.json"</span>, <span class="dt">package =</span> <span class="st">"sevenbridges"</span>)
<span class="kw"><a href="../reference/input_output_matrix.html">input_matrix</a></span>(tool.in)
<span class="kw"><a href="../reference/input_output_matrix.html">input_matrix</a></span>(tool.in, <span class="dt">required =</span> <span class="ot">TRUE</span>)
<span class="kw"><a href="../reference/input_output_matrix.html">input_matrix</a></span>(flow.in)
<span class="kw"><a href="../reference/input_output_matrix.html">input_matrix</a></span>(flow.in, <span class="kw">c</span>(<span class="st">"id"</span>, <span class="st">"type"</span>))
<span class="kw"><a href="../reference/input_output_matrix.html">input_matrix</a></span>(flow.in, <span class="dt">required =</span> <span class="ot">TRUE</span>)
<span class="kw"><a href="../reference/input_output_matrix.html">output_matrix</a></span>(tool.in)
<span class="kw"><a href="../reference/input_output_matrix.html">output_matrix</a></span>(flow.in)</code></pre></div>
<p>In the response body, locate the names of the required inputs. Note that task inputs need to match the expected data type and name. In the above example, we see two required fields:</p>
<ul>
<li>
<strong>fastq:</strong> This input takes a file array as indicated by “File…”</li>
<li>
<strong>genomeFastaFiles:</strong> This is a single file as indicated by “File”.</li>
</ul>
<p>We also want to provide a gene feature file:</p>
<ul>
<li>
<strong>sjdbGTFfile:</strong> A single file as indicated by “File”.</li>
</ul>
<p>You can find a list of possible input types below:</p>
<ul>
<li>
<strong>number, character or integer:</strong> you can directly pass these to the input parameter as it is.</li>
<li>
<strong>enum type:</strong> Pass this value to the input parameter.</li>
<li>**<a href="file:**" class="uri">file:**</a> This input is a file. However, while some inputs accept only single file (<code>File</code>), other inputs takes more than one file (<code>File</code> arrays, <code>FilesList</code>, or ‘<code>File...</code>’ ). This input require you to pass a <code>Files</code> object (for a single file input) or <code>FilesList</code> object (for inputs which accept more than one file) or simply a list in a “Files” object. You can search for your file by <code>id</code> or by <code>name</code> with an exact match (<code>exact = TRUE</code>), as shown in the example below.</li>
</ul>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="get-your-input-files-ready" class="section level3">
<h3 class="hasAnchor">
<a href="#get-your-input-files-ready" class="anchor"></a>Get your input files ready</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fastqs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"SRR1039508_1.fastq"</span>, <span class="st">"SRR1039508_2.fastq"</span>)

<span class="co"># get all 2 exact files</span>
fastq_in &lt;-<span class="st"> </span>p<span class="op">$</span><span class="kw">file</span>(<span class="dt">name=</span> fastqs, <span class="dt">exact =</span> <span class="ot">TRUE</span>)

<span class="co"># get a single file</span>
fasta_in &lt;-<span class="st"> </span>p<span class="op">$</span><span class="kw">file</span>(<span class="dt">name =</span> <span class="st">"Homo_sapiens.GRCh38.dna.primary_assembly.fa"</span>,
                   <span class="dt">exact =</span> <span class="ot">TRUE</span>)
<span class="co"># get all single file</span>
gtf_in &lt;-<span class="st"> </span>p<span class="op">$</span><span class="kw">file</span>(<span class="dt">name =</span> <span class="st">"Homo_sapiens.GRCh38.84.gtf"</span>,
                 <span class="dt">exact =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="create-a-new-draft-task" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-new-draft-task" class="anchor"></a>Create a new draft task</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># add new tasks</span>
taskName &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">"tengfei_star-alignment "</span>,<span class="kw">date</span>())

tsk &lt;-<span class="st"> </span>p<span class="op">$</span><span class="kw">task_add</span>(<span class="dt">name =</span> taskName,
                  <span class="dt">description =</span> <span class="st">"star test"</span>,
                  <span class="dt">app =</span> <span class="st">"tengfei/api-testing-2/newcopyofstar/0"</span>,
                  <span class="dt">inputs =</span> <span class="kw">list</span>(<span class="dt">sjdbGTFfile =</span> gtf_in,
                                <span class="dt">fastq =</span> fastq_in,
                                <span class="dt">genomeFastaFiles =</span> fasta_in))</code></pre></div>
<p>Remember the <code>fastq</code> input expects a list of files. You can also do something as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f1 &lt;-<span class="st"> </span>p<span class="op">$</span><span class="kw">file</span>(<span class="dt">name =</span> <span class="st">"SRR1039508_1.fastq"</span>, <span class="dt">exact =</span> <span class="ot">TRUE</span>)
f2 &lt;-<span class="st"> </span>p<span class="op">$</span><span class="kw">file</span>(<span class="dt">name =</span> <span class="st">"SRR1039508_2.fastq"</span>, <span class="dt">exact =</span> <span class="ot">TRUE</span>)
<span class="co"># get all 2 exact files</span>
fastq_in &lt;-<span class="st"> </span><span class="kw">list</span>(f1, f2)

<span class="co"># or if you know you only have 2 files whose names match SRR924146*.fastq</span>
fastq_in &lt;-<span class="st"> </span>p<span class="op">$</span><span class="kw">file</span>(<span class="dt">name =</span> <span class="st">"SRR1039508*.fastq"</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Using <code>complete = TRUE</code> when items is over 100.</p>
</div>
<div id="draft-a-batch-task" class="section level3">
<h3 class="hasAnchor">
<a href="#draft-a-batch-task" class="anchor"></a>Draft a batch task</h3>
<p>Now let’s do a batch with 8 files in 4 groups, which is batched by metadata <code>sample_id</code> and <code>library_id</code>. We will assume each file has these two metadata fields entered. Since these files can be evenly grouped into 4, we will have a single parent batch task with 4 child tasks.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fastqs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"SRR1039508_1.fastq"</span>, <span class="st">"SRR1039508_2.fastq"</span>, <span class="st">"SRR1039509_1.fastq"</span>,
            <span class="st">"SRR1039509_2.fastq"</span>, <span class="st">"SRR1039512_1.fastq"</span>, <span class="st">"SRR1039512_2.fastq"</span>,
            <span class="st">"SRR1039513_1.fastq"</span>, <span class="st">"SRR1039513_2.fastq"</span>)

<span class="co"># get all 8 files</span>
fastq_in &lt;-<span class="st"> </span>p<span class="op">$</span><span class="kw">file</span>(<span class="dt">name=</span> fastqs, <span class="dt">exact =</span> <span class="ot">TRUE</span>)
<span class="co"># can also try to returned all SRR*.fastq files</span>
<span class="co"># fastq_in &lt;- p$file(name= "SRR*.fastq", complete = TRUE)</span>

tsk &lt;-<span class="st"> </span>p<span class="op">$</span><span class="kw">task_add</span>(<span class="dt">name =</span> taskName,
                  <span class="dt">description =</span> <span class="st">"Batch Star Test"</span>,
                  <span class="dt">app =</span> <span class="st">"tengfei/api-testing-2/newcopyofstar/0"</span>,
                  <span class="dt">batch =</span> <span class="kw"><a href="../reference/batch.html">batch</a></span>(<span class="dt">input =</span> <span class="st">"fastq"</span>,
                                <span class="dt">criteria =</span> <span class="kw">c</span>(<span class="st">"metadata.sample_id"</span>,<span class="st">"metadata.noexist_id"</span>)),
                  <span class="dt">inputs =</span> <span class="kw">list</span>(<span class="dt">sjdbGTFfile =</span> gtf_in,
                                <span class="dt">fastq =</span> fastqs_in,
                                <span class="dt">genomeFastaFiles =</span> fasta_in))</code></pre></div>
<p>Now you have a draft batch task, please check it out in the visual interface. Your response body should inform you of any errors or warnings.</p>
<p>Note: you can also directly pass file id or file names as characters to inputs list, the package will first guess if the passed strings are file id (24 bit hexdecimal) or names, then convert it to Files or FilesList object. However, as a good practice, we recommend you construct your files object(e.g. <code>p$file(id = , name = )</code>) first, check the value, then pass it to <code>task_add</code> inputs, this is a more safe approach.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="run-a-task" class="section level2">
<h2 class="hasAnchor">
<a href="#run-a-task" class="anchor"></a>Run a Task</h2>
<p>Now, we are ready to run our task.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># run your task</span>
tsk<span class="op">$</span><span class="kw">run</span>()</code></pre></div>
<p>Before you run your task, you can adjust your draft task if you have any final modifications. Or, you can delete the draft task if you no longer wish to run it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># # not run</span>
<span class="co"># tsk$delete()</span></code></pre></div>
<p>After you run a task, you can abort it</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># abort your task</span>
tsk<span class="op">$</span><span class="kw">abort</span>()</code></pre></div>
<p>If you want to update your task and then re-run it, follow the example below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tsk<span class="op">$</span><span class="kw">getInputs</span>()
<span class="co"># missing number input, only update number</span>
tsk<span class="op">$</span><span class="kw">update</span>(<span class="dt">inputs =</span> <span class="kw">list</span>(<span class="dt">sjdbGTFfile =</span> <span class="st">"some new file"</span>))
<span class="co"># double check</span>
tsk<span class="op">$</span><span class="kw">getInputs</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="task-monitoring" class="section level2">
<h2 class="hasAnchor">
<a href="#task-monitoring" class="anchor"></a>Task Monitoring</h2>
<p>To monitor your task as it runs, you can always request a task <code>update</code> to ask your task to report its status. Or, you can monitor a running task with a hook function, which triggers the function when that status is “completed”. Please check the details in <a href="#hooktask">section</a> below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tsk<span class="op">$</span><span class="kw">update</span>()</code></pre></div>
<p>By default, your task alerts you by email when it has been completed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Monitor your task (skip this part)</span>
<span class="co"># tsk$monitor()</span></code></pre></div>
<p>Use the following to download all files from a completed task.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tsk<span class="op">$</span><span class="kw"><a href="../reference/download-methods.html">download</a></span>(<span class="st">"~/Downloads"</span>)</code></pre></div>
<p><a name="hooktask"></a>Instead of the default task monitor action, you can use <code>setTaskHook</code> to connect a function call to the status of a task. When you run <code>tsk$monitor(time = 30)</code> it will check your task every 30 seconds to see if the current task status matches one of the following statuses: “queued”, “draft”, “running”, “completed”, “aborted”, and “failed”. When it finds a match for the task status, <code>getTaskHook</code> returns the function call for the specific status.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/TaskHook.html">getTaskHook</a></span>(<span class="st">"completed"</span>)</code></pre></div>
<pre><code>## function(...) {
##                     cat("\r", "completed")
##                     return(TRUE)
##                 }
## &lt;environment: 0x7fe91eea30d8&gt;</code></pre>
<p>If you want to customize the monitor function, you can adjust the following requirement. Your function must return <code>TRUE</code> or <code>FALSE</code> in the end. When it is <code>TRUE</code> (or non-logical value) it means the monitoring will be terminated after it finds a status matched and the function executes, such as when the task is completed. When it is <code>FALSE</code> it means the monitoring will continue for the next iteration of checking, e.g. when it is “running”, you want to keep tracking.</p>
<p>Follow the example below to set a new function to monitor the status “completed”. Then, when the task is completed, it will download all task output files to local folder.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/TaskHook.html">setTaskHook</a></span>(<span class="st">"completed"</span>, <span class="cf">function</span>(){
    tsk<span class="op">$</span><span class="kw"><a href="../reference/download-methods.html">download</a></span>(<span class="st">"~/Downloads"</span>)
    <span class="kw">return</span>(<span class="ot">TRUE</span>)
})
tsk<span class="op">$</span><span class="kw">monitor</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
<p><a name="reference"></a></p>
</div>
</div>
<div id="seven-bridges-api-reference" class="section level1">
<h1 class="hasAnchor">
<a href="#seven-bridges-api-reference" class="anchor"></a>Seven Bridges API Reference</h1>
<p>The <code>sevenbridges</code> package provides a user-friendly interface so you do not have to combine several <code><a href="../reference/api.html">api()</a></code> calls and constantly reference the API documentation to issue API requests.</p>
<div align="right">
<a href="#top">top</a>
</div>
<p><a name="auth-reference"></a></p>
<div id="authentication" class="section level2">
<h2 class="hasAnchor">
<a href="#authentication" class="anchor"></a>Authentication</h2>
<p>Before you can interact with the API, you need to construct an <code>Auth</code> object which stores the following information:</p>
<ul>
<li>Your authentication token. This is used to authenticate your credentials with the API. Learn more about obtaining your authentication token on the <a href="https://docs.sevenbridges.com/v1.0/docs/get-your-authentication-token">Seven Bridges Platform</a> and the <a href="http://docs.cancergenomicscloud.org/v1.0/docs/get-your-authentication-token">Cancer Genomics Cloud</a>. The approach for obtaining the authentication token also applies to the other Seven Bridges platforms.</li>
<li>The path for the API (base URL).</li>
<li>The platform name you are using (e.g. Seven Bridges Platform on AWS US, Seven Bridges Platform on AWS EU, Seven Bridges Platform on GCP, Cancer Genomics Cloud, or Cavatica). This is an optional field, as the base URL of the API ultimately decides where the API calls will be sent to. This field will only be blank when the URL was directly provided and the platform name could not be inferred from that URL.</li>
</ul>
<p>The general authentication logic for <code><a href="../reference/Auth-class.html">Auth()</a></code> is as follows:</p>
<ol style="list-style-type: decimal">
<li>The package will use the direct authentication method if <code>from</code> is not specified explicitly or specified as <code>from = "direct"</code>.</li>
<li>The package will load the authentication information from environment variables when <code>from = "env"</code>, or user configuration file when <code>from = "file"</code>.</li>
</ol>
<div id="direct-authentication" class="section level3">
<h3 class="hasAnchor">
<a href="#direct-authentication" class="anchor"></a>Direct authentication</h3>
<p>To use direct authentication, users need to specify one of <code>platform</code> or <code>url</code>, with the corresponding <code>token</code>. Examples of direct authentication:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a =<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">token =</span> <span class="st">"1c0e6e202b544030870ccc147092c250"</span>,
         <span class="dt">platform =</span> <span class="st">"aws-us"</span>)</code></pre></div>
<p>The above will use the Seven Bridges Platform on AWS (US).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a =<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">token =</span> <span class="st">"1c0e6e202b544030870ccc147092c257"</span>,
         <span class="dt">url =</span> <span class="st">"https://gcp-api.sbgenomics.com/v2"</span>)</code></pre></div>
<p>The above will use the specified <code>url</code> as base URL for the API calls. In this example, the <code>url</code> points to the Seven Bridges Platform on Google Cloud Platform (GCP).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a =<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">token =</span> <span class="st">"2c0e6e202b544030870ccc147092c257"</span>)</code></pre></div>
<p>The above will use the Cancer Genomics Cloud environment, since no <code>platform</code> nor <code>url</code> were explicitly specified (not recommended).</p>
<p><strong><em>Note:</em></strong> <code>platform</code> and <code>url</code> should not be specified in the same time.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="authentication-via-system-environment-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#authentication-via-system-environment-variables" class="anchor"></a>Authentication via system environment variables</h3>
<p>The R API client supports reading authentication information stored in system environment variables.</p>
<p>To set the two environment variables in your system, you could use the function <code><a href="../reference/sbg_set_env.html">sbg_set_env()</a></code>. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/sbg_set_env.html">sbg_set_env</a></span>(<span class="dt">url =</span> <span class="st">"https://cgc-api.sbgenomics.com/v2"</span>,
            <span class="dt">token =</span> <span class="st">"your_token"</span>)</code></pre></div>
<p>See if the environment variables are correctly set:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/sbg_get_env.html">sbg_get_env</a></span>(<span class="st">"SB_API_ENDPOINT"</span>)
## "https://cgc-api.sbgenomics.com/v2"
<span class="kw"><a href="../reference/sbg_get_env.html">sbg_get_env</a></span>(<span class="st">"SB_AUTH_TOKEN"</span>)
## "your_token"</code></pre></div>
<p>To create an <code>Auth</code> object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">from =</span> <span class="st">"env"</span>)</code></pre></div>
<p>To unset the two environment variables:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Sys.unsetenv</span>(<span class="st">"SB_API_ENDPOINT"</span>)
<span class="kw">Sys.unsetenv</span>(<span class="st">"SB_AUTH_TOKEN"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="authentication-via-user-configuration-file" class="section level3">
<h3 class="hasAnchor">
<a href="#authentication-via-user-configuration-file" class="anchor"></a>Authentication via user configuration file</h3>
<p>You can create an ini-like file named <code>credentials</code> under the folder <code>$HOME/.sevenbridges/</code> and maintain your credentials for multiple accounts across various Seven Bridges environments. An example:</p>
<pre><code>[aws-us-tengfei]
api_endpoint = https://api.sbgenomics.com/v2
auth_token = token_for_this_user

# This is a comment:
# another user on the same platform
[aws-us-yintengfei]
api_endpoint = https://api.sbgenomics.com/v2
auth_token = token_for_this_user

[default]
api_endpoint = https://cgc-api.sbgenomics.com/v2
auth_token = token_for_this_user

[gcp]
api_endpoint = https://gcp-api.sbgenomics.com/v2
auth_token = token_for_this_user</code></pre>
<p>Please make sure to have two fields <strong>exactly</strong> named as <code>api_endpoint</code> and <code>auth_token</code> under each profile.</p>
<p>To load the default profile (named <code>[default]</code>) from the default user configuration file (<code>$HOME/.sevenbridges/credentials</code>), please use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">from =</span> <span class="st">"file"</span>)</code></pre></div>
<p>To load the user profile <code>aws-us-tengfei</code> from this configuration file, change the <code>profile_name</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">from =</span> <span class="st">"file"</span>, <span class="dt">profile_name =</span> <span class="st">"aws-us-tengfei"</span>)</code></pre></div>
<p>To use a user configuration file from other locations (not recommended), please specify the file path using the argument <code>config_file</code>. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">from =</span> <span class="st">"file"</span>, <span class="dt">config_file =</span> <span class="st">"~/sevenbridges.cfg"</span>,
          <span class="dt">profile_name =</span> <span class="st">"aws-us-tengfei"</span>)</code></pre></div>
<p><strong><em>Note:</em></strong> If you edited the <code>credentials</code> file, please use <code><a href="../reference/Auth-class.html">Auth()</a></code> to re-authenticate.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="list-all-api-calls" class="section level2">
<h2 class="hasAnchor">
<a href="#list-all-api-calls" class="anchor"></a>List All API Calls</h2>
<p>If you did not pass any parameters to <code><a href="../reference/api.html">api()</a></code> from <code>Auth</code>, it will list all API calls. Any parameters you provide will be passed to the <code><a href="../reference/api.html">api()</a></code> function, but you do not have to pass your input token and path once more ince the <code>Auth</code> object already has this information. The following call fromt he <code>Auth</code> object will check the response as well.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw"><a href="../reference/api.html">api</a></span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="offset-limit-search-and-advance-access-features" class="section level2">
<h2 class="hasAnchor">
<a href="#offset-limit-search-and-advance-access-features" class="anchor"></a>Offset, Limit, Search, and Advance Access Features</h2>
<div id="offset-and-limit" class="section level3">
<h3 class="hasAnchor">
<a href="#offset-and-limit" class="anchor"></a><code>offset</code> and <code>limit</code>
</h3>
<p>Every API call accepts two arguments named <code>offset</code> and <code>limit</code>.</p>
<ul>
<li>
<code>offset</code> defines where the retrieved items started.</li>
<li>
<code>limit</code> defines the quantity of items you want to get.</li>
</ul>
<p>By default, <code>offset</code> is set to <code>0</code> and <code>limit</code> is set to <code>50</code>. As such, your API request returns the <strong>first 100 items</strong> when you list items or search for items by name. To search and list all items, use <code>complete = TRUE</code> in your API request.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">getOption</span>(<span class="st">"sevenbridges"</span>)<span class="op">$</span>offset
<span class="kw">getOption</span>(<span class="st">"sevenbridges"</span>)<span class="op">$</span>limit</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="search-by-id" class="section level3">
<h3 class="hasAnchor">
<a href="#search-by-id" class="anchor"></a>Search by ID</h3>
<p>When searching by ID, your request will return your exact resource as it is unique. As such, you do not have to manually set <code>offset</code> and <code>limit</code>. It is a good practice to find your resources by their ID and pass this ID as an input to your task. You can find a resource’s ID in the final part of the URL on the visual interface or via the API requests to list resources or get a resource’s details.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="search-by-name" class="section level3">
<h3 class="hasAnchor">
<a href="#search-by-name" class="anchor"></a>Search by name</h3>
<p>Search by name returns all partial matches unless you specify <code>exact = TRUE</code>. This type of search will only search across current pulled content, so use <code>complete = TRUE</code> if you want to search across everything.</p>
<p>For example, to list all public apps, use <code>visibility</code> argument, but make sure you pass <code>complete = TRUE</code> to it, to show every single things. This arguments generally works for items like “App”, “Project”, “Task”, “File”, etc.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># first, search by id is fast</span>
x =<span class="st"> </span>a<span class="op">$</span><span class="kw">app</span>(<span class="dt">visibility =</span> <span class="st">"public"</span>, <span class="dt">id =</span> <span class="st">"admin/sbg-public-data/sbg-ucsc-b37-bed-converter/1"</span>)

<span class="co"># show 100 items from public</span>
x =<span class="st">  </span>a<span class="op">$</span><span class="kw">app</span>(<span class="dt">visibility =</span> <span class="st">"public"</span>)
<span class="kw">length</span>(x)  <span class="co"># 100</span>

x =<span class="st"> </span>a<span class="op">$</span><span class="kw">app</span>(<span class="dt">visibility =</span> <span class="st">"public"</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)
<span class="kw">length</span>(x)  <span class="co"># 272 by Nov 2016</span>
<span class="co"># this return nothing, because it is not in the first 100 returned names</span>
a<span class="op">$</span><span class="kw">app</span>(<span class="dt">visibility =</span> <span class="st">"public"</span>, <span class="dt">name =</span> <span class="st">"bed converter"</span>)
<span class="co"># this return an app, because it pulls *all* app names and did search</span>
a<span class="op">$</span><span class="kw">app</span>(<span class="dt">visibility =</span> <span class="st">"public"</span>, <span class="dt">name =</span> <span class="st">"bed converter"</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="experiment-with-advance-access-features" class="section level3">
<h3 class="hasAnchor">
<a href="#experiment-with-advance-access-features" class="anchor"></a>Experiment with Advance Access features</h3>
<p>Similar to <code>offset</code> and <code>limit</code>, every API call accepts an argument named <code>advance_access</code>. This argument was first introduced in August 2017 and controls if a special field in the HTTP request header will be sent, which can enable the access to the “Advance Access” features in the Seven Bridges API. Note that the Advance Access features in the API are <strong>not officially released yet</strong>, therefore the API usages are subject to change, so please use with discretion.</p>
<p>In addition to modifying each API call that uses Advance Access features, the option can be also set globally at the beginning of your API script. This offers a one-button switch for users who wants to experiment with the Advance Access features. The option is disabled by default:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"sevenbridges"</span>)
<span class="kw">getOption</span>(<span class="st">"sevenbridges"</span>)<span class="op">$</span>advance_access</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>For example, the “folders” API is in Advance Access as of August, 2017. If we try to use the folders API to create a folder with the <code>advance_access</code> option disabled, it will return an error message:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">req =<span class="st"> </span><span class="kw"><a href="../reference/api.html">api</a></span>(
    <span class="dt">token =</span> <span class="st">"your_token"</span>, <span class="dt">path =</span> <span class="st">"files"</span>,
    <span class="dt">method =</span> <span class="st">"POST"</span>, <span class="dt">body =</span> <span class="kw">list</span>(
        <span class="st">"name"</span> =<span class="st"> "new-folder"</span>, <span class="st">"type"</span> =<span class="st"> "folder"</span>,
        <span class="st">"project"</span> =<span class="st"> "owner/project"</span>))

httr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/httr/topics/content">content</a></span>(req)<span class="op">$</span><span class="st">"message"</span></code></pre></div>
<pre><code>## [1] "Advance access feature needs X-SBG-Advance-Access: advance header."</code></pre>
<p>To enable the Advance Access features, one can use</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opt =<span class="st"> </span><span class="kw">getOption</span>(<span class="st">"sevenbridges"</span>)
opt<span class="op">$</span>advance_access =<span class="st"> </span><span class="ot">TRUE</span>
<span class="kw">options</span>(<span class="dt">sevenbridges =</span> opt)</code></pre></div>
<p>at the beginning of their scripts. Let’s check if the option has been enabled:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">getOption</span>(<span class="st">"sevenbridges"</span>)<span class="op">$</span>advance_access</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Send the API call again:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">req =<span class="st"> </span><span class="kw"><a href="../reference/api.html">api</a></span>(
    <span class="dt">token =</span> <span class="st">"your_token"</span>, <span class="dt">path =</span> <span class="st">"files"</span>,
    <span class="dt">method =</span> <span class="st">"POST"</span>, <span class="dt">body =</span> <span class="kw">list</span>(
        <span class="st">"name"</span> =<span class="st"> "new-folder"</span>, <span class="st">"type"</span> =<span class="st"> "folder"</span>,
        <span class="st">"project"</span> =<span class="st"> "owner/project"</span>))</code></pre></div>
<p>The information of the newly created folder will be returned:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">httr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/httr/topics/content">content</a></span>(req)</code></pre></div>
<pre><code>## $href
## [1] "https://api.sbgenomics.com/v2/files/{folder_id}"
##
## $id
## [1] "folder_id"
##
## $name
## [1] "new-folder"
##
## $project
## [1] "owner/project"
##
## $parent
## [1] "parent_folder_id"
##
## $type
## [1] "folder"
##
## $created_on
## [1] "2017-08-22T12:49:21Z"
##
## $modified_on
## [1] "2017-08-22T12:49:21Z"</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="query-parameter-fields" class="section level2">
<h2 class="hasAnchor">
<a href="#query-parameter-fields" class="anchor"></a>Query Parameter <code>'fields'</code>
</h2>
<p>Please read the documentation <a href="https://docs.sevenbridges.com/reference#section-general-api-information">detail</a>.</p>
<p>All API calls take the optional query parameter fields. This parameter enables you to specify the fields you want to be returned when listing resources (e.g. all your projects) or getting details of a specific resource (e.g. a given project).</p>
<p>The fields parameter can be used in the following ways:</p>
<ol style="list-style-type: decimal">
<li><p>No <code>fields</code> parameter specified: calls return default fields. For calls that return complete details of a single resource, this is all their properties; for calls that list resources of a certain type, this is some default properties.</p></li>
<li><p>The <code>fields</code> parameter can be set to a list of fields: for example, to return the fields id, name and size for files in a project, you may issue the call <code>p$file(fields = "id,name,size")</code></p></li>
<li><p>The fields parameter can be used to exclude a specific file: if you wish to omit certain field from the response, do so using the fields parameter with the prefix <code>!</code>. For example, to get the details of a file without listing its metadata, issue a call <code>p$file(fields = '!metadata')</code> The entire metadata field will be removed from the response.</p></li>
<li><p>The fields parameter can be used to include or omit certain nested fields, in the same way as listed in 2 and 3 above: for example, you can use <code>metadata.sample_id</code> or <code>origin.task</code> for files.</p></li>
<li><p>To see all fields for a resource, specify <code>fields="_all"</code>. This returns all fields for each resource returned. Note that if you are getting the details of a specific resource, the use of <code>fields="_all"</code> won’t return any more properties than would have been shown without this parameter — the use case is instead for when you are listing details of many resources. Please use with care if your resource has particularly large fields; for example, the raw field for an app resource contains the complete CWL specification of the app which can result in bulky response if listing many apps.</p></li>
<li><p>Negations and nesting can be combined freely, so, for example, you can issue <code>p$file(fields="id,name,status,!metadata.library,!origin")</code> or <code>p$task(fields="!inputs,!outputs")</code>.</p></li>
</ol>
<p>Please try following examples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## default fields id, name, project
p<span class="op">$</span><span class="kw">file</span>()
## return file(s) with id, name, siae information
p<span class="op">$</span><span class="kw">file</span>(<span class="dt">fields =</span> <span class="st">"id,name,size"</span>)
## return file(s) with all available info
p<span class="op">$</span><span class="kw">file</span>(<span class="dt">detail =</span> <span class="ot">TRUE</span>)
## same as above
p<span class="op">$</span><span class="kw">file</span>(<span class="dt">fields =</span> <span class="st">"_all"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="rate-limits" class="section level2">
<h2 class="hasAnchor">
<a href="#rate-limits" class="anchor"></a>Rate Limits</h2>
<p>This call returns information about your current rate limit. This is the number of API calls you can make in one hour.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">rate_limit</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="users" class="section level2">
<h2 class="hasAnchor">
<a href="#users" class="anchor"></a>Users</h2>
<p>This call returns a list of the resources, such as projects, billing groups, and organizations, that are accessible to you. Currently, this call will only return a successful response if {username} is replaced with your own username. Be sure to capitalize your username in the same way as when you registered for an account.</p>
<p>If you did not provide a username, your user information will be shown.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># return your information</span>
a<span class="op">$</span><span class="kw">user</span>()
<span class="co"># return user tengfei's information</span>
a<span class="op">$</span><span class="kw">user</span>(<span class="st">"tengfei"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="billing-group-and-invoices" class="section level2">
<h2 class="hasAnchor">
<a href="#billing-group-and-invoices" class="anchor"></a>Billing Group and Invoices</h2>
<div id="for-billing" class="section level3">
<h3 class="hasAnchor">
<a href="#for-billing" class="anchor"></a>For billing</h3>
<p>If no billing group <code>id</code> is provided, this call returns a list of paths used to access billing information via the API. If a username is provided, this call lists all your billing groups, including groups that are pending or which have been disabled. If you specify <code>breakdown = TRUE</code>, the call below returns a breakdown of the spending per-project for the billing group specified by billing_group. Information is also displayed for each of the projects a particular billing group is associated with, including task executions, their initiating user, start and end time, and their cost.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># return a BillingList object</span>
(b &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">billing</span>())
a<span class="op">$</span><span class="kw">billing</span>(<span class="dt">id =</span> b<span class="op">$</span>id, <span class="dt">breakdown =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="for-invoices" class="section level3">
<h3 class="hasAnchor">
<a href="#for-invoices" class="anchor"></a>For invoices</h3>
<p>If no Billing Group <code>id</code> provided, This call returns a list of invoices, with information about each, including whether or not the invoice is pending and the billing period it covers. This call returns information about all your available invoices, unless you use the query parameter bg_id to specify the ID of a particular Billing Group, in which case it will return the invoice incurred by that Billing Group only. If an invoice <code>id</code> is provided, this call retrieves information about the specified invoice, including the costs for analysis and storage and the invoice period.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">invoice</span>()
a<span class="op">$</span><span class="kw">invoice</span>(<span class="dt">id =</span> <span class="st">"fake_id"</span>)</code></pre></div>
<p><strong><em>Note:</em></strong> Currently, invoice is not an object. Instead, it just returns a list.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="project" class="section level2">
<h2 class="hasAnchor">
<a href="#project" class="anchor"></a>Project</h2>
<p>Projects are the basic units to organize different entities: files, tasks, apps, etc. As such, many actions stem from the <code>Project</code> object.</p>
<div align="right">
<a href="#top">top</a>
</div>
<div id="list-all-projects" class="section level3">
<h3 class="hasAnchor">
<a href="#list-all-projects" class="anchor"></a>List all projects</h3>
<p>The following call returns a list of all projects of which you are a member. Each project’s <code>project_id</code> and path will be returned.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">project</span>()</code></pre></div>
<p>If you want to list the projects owned by and accessible to a particular user, specify the <code>owner</code> argument as follows. Each project’s ID and path will be returned.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">project</span>(<span class="dt">owner =</span> <span class="st">"tengfei"</span>)
a<span class="op">$</span><span class="kw">project</span>(<span class="dt">owner =</span> <span class="st">"yintengfei"</span>)</code></pre></div>
<p>To get details about project(s), use <code>detail = TRUE</code>, as shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">project</span>(<span class="dt">detail =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="partial-match-project-name" class="section level3">
<h3 class="hasAnchor">
<a href="#partial-match-project-name" class="anchor"></a>Partial match project name</h3>
<p>For a more friendly interface and convenient search, the <code>sevenbridges</code> package supports <em>partial name matching</em>. The first argument for the following request is <code>name</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># want to return a project called</span>
a<span class="op">$</span><span class="kw">project</span>(<span class="st">"hello"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="create-a-new-project" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-new-project" class="anchor"></a>Create a new project</h3>
<p>To create a new project, users need to specify the following:</p>
<ul>
<li>
<code>name</code> (required)</li>
<li>
<code>billing_group_id</code> (required)</li>
<li>
<code>description</code> (optional)</li>
<li>
<code>tags</code> (optional): This has to be a list(). If you are using the API on the CGC environment, you can create a TCGA Controlled Data project by specifying <code>TCGA</code> in <code>tags</code>.</li>
<li>
<code>type</code> (optional): By default, we create a V2, CWL compatible project.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">project_new</span>(<span class="st">"api_testing_tcga"</span>, b<span class="op">$</span>id,
              <span class="dt">description =</span> <span class="st">"Test for API"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="create-a-new-project-with-tcga-controlled-data-on-cgc" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-new-project-with-tcga-controlled-data-on-cgc" class="anchor"></a>Create a new project with TCGA controlled data on CGC</h3>
<p>Follow the directions above, but pass <code>tcga</code> as a value for <code>tags</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">project_new</span>(<span class="st">"controlled_project"</span>, b<span class="op">$</span>id,
              <span class="dt">description =</span> <span class="st">"Test for API"</span>, <span class="dt">tags =</span> <span class="kw">list</span>(<span class="st">"tcga"</span>))</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="delete-a-project" class="section level3">
<h3 class="hasAnchor">
<a href="#delete-a-project" class="anchor"></a>Delete a project</h3>
<p>You can delete a <em>single</em> project by making the request to <code>$delete()</code>. Note that the returned object from <code>a$project()</code> sometimes returns list if you use partial matching by name. The <code>$delete()</code> request cannot operate on a list. If you want to operate on a list of object, read more about batch functions in the relevant section below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># remove it, not run</span>
a<span class="op">$</span><span class="kw">project</span>(<span class="st">"api_testing"</span>)<span class="op">$</span><span class="kw"><a href="../reference/delete-methods.html">delete</a></span>()
<span class="co"># check</span>
<span class="co"># will delete all projects match the name</span>
<span class="kw"><a href="../reference/delete-methods.html">delete</a></span>(a<span class="op">$</span><span class="kw">project</span>(<span class="st">"api_testing_donnot_delete_me"</span>))</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="updateedit-a-project" class="section level3">
<h3 class="hasAnchor">
<a href="#updateedit-a-project" class="anchor"></a>Update/edit a project</h3>
<p>You can update the following information about an existing project:</p>
<ul>
<li><code>name</code></li>
<li><code>description</code></li>
<li><code>billing_group_id</code></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/helloworld"</span>)
a<span class="op">$</span><span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/helloworld"</span>)<span class="op">$</span><span class="kw">update</span>(<span class="dt">name =</span> <span class="st">"Hello World Update"</span>,
                                            <span class="dt">description =</span> <span class="st">"Update description"</span>)</code></pre></div>
</div>
<div id="project-member" class="section level3">
<h3 class="hasAnchor">
<a href="#project-member" class="anchor"></a>Project member</h3>
<div id="list-members" class="section level4">
<h4 class="hasAnchor">
<a href="#list-members" class="anchor"></a>List members</h4>
<p>This call returns a list of the members of the specified project. For each member, the response lists:</p>
<ul>
<li>The member’s username</li>
<li>The member’s permissions in the specified project</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo-project"</span>)<span class="op">$</span><span class="kw">member</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="add-a-member" class="section level4">
<h4 class="hasAnchor">
<a href="#add-a-member" class="anchor"></a>Add a member</h4>
<p>This call adds a new user to the specified project. It can only be made by a user who has admin permissions in the project.</p>
<p>Requests to add a project member must include the key <code>permissions</code>. However, if you do not include a value, the member’s permissions will be set to <code>false</code> by default.</p>
<p>Set permission by passing the following values: <code>copy</code>, <code>write</code>, <code>execute</code>, <code>admin</code>, or <code>read</code>.</p>
<p>Note: <code>read</code> is implicit and set by default. You can not be a project member without having <code>read</code> permissions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo-project"</span>)<span class="op">$</span>
<span class="st">       </span><span class="kw">member_add</span>(<span class="dt">username =</span> <span class="st">"yintengfei"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="update-a-member" class="section level4">
<h4 class="hasAnchor">
<a href="#update-a-member" class="anchor"></a>Update a member</h4>
<p>This call edits a user’s permissions in the specified project. It can only be made by a user who has admin permissions in the project.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo-project"</span>)<span class="op">$</span>
<span class="st">       </span><span class="kw">member</span>(<span class="dt">username =</span> <span class="st">"yintengfei"</span>)
m<span class="op">$</span><span class="kw">update</span>(<span class="dt">copy =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>== Member ==
username : yintengfei
-- Permission --
read : TRUE
write : FALSE
copy_permission : TRUE
execute : FALSE
admin : FALSE</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="delete-a-member" class="section level4">
<h4 class="hasAnchor">
<a href="#delete-a-member" class="anchor"></a>Delete a member</h4>
<p>To delete an existing member, just call the <code><a href="../reference/delete-methods.html">delete()</a></code> action on the <code>Member</code> object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m<span class="op">$</span><span class="kw"><a href="../reference/delete-methods.html">delete</a></span>()
<span class="co"># confirm</span>
a<span class="op">$</span><span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo-project"</span>)<span class="op">$</span><span class="kw">member</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="list-all-files" class="section level3">
<h3 class="hasAnchor">
<a href="#list-all-files" class="anchor"></a>List all files</h3>
<p>To list all files belonging to a project, use the following request:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo-project"</span>)
p<span class="op">$</span><span class="kw">file</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="files-metadata-and-tags" class="section level2">
<h2 class="hasAnchor">
<a href="#files-metadata-and-tags" class="anchor"></a>Files, Metadata, and Tags</h2>
<div id="list-all-files-1" class="section level3">
<h3 class="hasAnchor">
<a href="#list-all-files-1" class="anchor"></a>List all files</h3>
<p>A better way to list files in a project uses the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># first 100 files, default offset = 0, limit = 100</span>
p<span class="op">$</span><span class="kw">file</span>()
<span class="co"># list all files</span>
p<span class="op">$</span><span class="kw">file</span>(<span class="dt">complete =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Alternatively you can get files from the <code>Auth</code> object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">file</span>(<span class="dt">project =</span> p<span class="op">$</span>id)
a<span class="op">$</span><span class="kw">file</span>(<span class="dt">name =</span> <span class="st">"omni"</span>, <span class="dt">project =</span> p<span class="op">$</span>id, <span class="dt">detail =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="search-and-filter-files" class="section level3">
<h3 class="hasAnchor">
<a href="#search-and-filter-files" class="anchor"></a>Search and filter file(s)</h3>
<div id="rule-of-thumb" class="section level4">
<h4 class="hasAnchor">
<a href="#rule-of-thumb" class="anchor"></a>Rule of thumb</h4>
<p>You can easily search by partial name, exact name, or id for many items like project, apps, files. Fortunately, we have more powerful filters for files. User could serach by metadata, tags, and original task id.</p>
<ol style="list-style-type: decimal">
<li><p><strong>First rule: understand the scope</strong>: We know we have default <code>limit = 100</code> and <code>offset = 0</code> for first 100 items, unless you are using arguments <code>complete = TRUE</code>. Things are different when it comes to files. When you search with exact name (search by name with <code>exact = TRUE</code> on), metadata, or tags, it searches through ALL files. You do not have to specify <code>complete = TRUE</code>. Simply provide the project id or make the call from a project object as shown below.</p></li>
<li><p><strong>Second rule: understand the operation</strong>: When filtering on any resource, including the same field several times with different filtering criteria results in an implicit OR operation for that field and the different criteria.When filtering by different specified fields, an implicit AND is performed between those criteria." so which are different fields, metadata, origin.task, tags, those are different fields. <strong>Note</strong> different metadata fields are treated as different fields as well, so it will be <strong>AND</strong> operation for different metadata field.</p></li>
</ol>
<p>So for a quick example, this examples gives me all files in project “tengfei/demo” that with metadata sample_id “Sample1” <strong>OR</strong> “Sample2”, <strong>AND</strong> the library id has to be “EXAMPLE”, <strong>AND</strong> tags has either “hello” <strong>OR</strong> “world”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p =<span class="st"> </span>a<span class="op">$</span><span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo"</span>)
p<span class="op">$</span><span class="kw">file</span>(<span class="dt">metadata =</span> <span class="kw">list</span>(<span class="dt">sample_id =</span> <span class="st">"Sample1"</span>,
                       <span class="dt">sample_id =</span> <span class="st">"Sample2"</span>,
                       <span class="dt">library_id =</span> <span class="st">"EXAMPLE"</span>),
       <span class="dt">tag =</span> <span class="kw">c</span>(<span class="st">"hello"</span>, <span class="st">"world"</span>))</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="search-by-name-and-id" class="section level4">
<h4 class="hasAnchor">
<a href="#search-by-name-and-id" class="anchor"></a>Search by name and id</h4>
<p>There are two ways to return the exact file you want. One is by <code>id</code>, the other one is by exact <code>name</code>.</p>
<p><strong><em>For advanced users:</em></strong> When searching by name with <code>exact = TRUE</code>, it directly uses our public API call to match exact name and return the object with a single query. When you turn off <code>exact</code>, it will <code>grep</code> all files or files defined with <code>limit</code> and <code>offset</code> first, then match by name, which could be slow.</p>
<p>To get the file id, you can check the url on the visual interface from the file details page.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># return single object id is "some_file_id"</span>
p<span class="op">$</span><span class="kw">file</span>(<span class="dt">id =</span> <span class="st">"some_file_id"</span>)
<span class="co"># return a single object named a.fastq</span>
p<span class="op">$</span><span class="kw">file</span>(<span class="dt">name =</span> <span class="st">"a.fastq"</span>, <span class="dt">exact =</span> <span class="ot">TRUE</span>)
<span class="co"># public file search using Auth object</span>
a<span class="op">$</span><span class="kw">public_file</span>(<span class="dt">name =</span> <span class="st">"ucsc.hg19.fasta.fai"</span>, <span class="dt">exact =</span> <span class="ot">TRUE</span>)
a<span class="op">$</span><span class="kw">public_file</span>(<span class="dt">id =</span> <span class="st">"578cf94a507c17681a3117e8"</span>)</code></pre></div>
<p>To get more than one object, the arguments <code>id</code> and <code>name</code> both accept vectors, so you can pass more than one <code>id</code> or <code>name</code> to it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get two files</span>
p<span class="op">$</span><span class="kw">file</span>(<span class="dt">name =</span> <span class="kw">c</span>(<span class="st">"test1.fastq"</span>, <span class="st">"test2.fastq"</span>), <span class="dt">exact =</span> <span class="ot">TRUE</span>)
<span class="co"># get two files from public files using shorthand</span>
a<span class="op">$</span><span class="kw">public_file</span>(<span class="dt">name =</span> <span class="kw">c</span>(<span class="st">"ucsc.hg19.fasta.fai"</span>, <span class="st">"ucsc.hg19.fasta"</span>),
              <span class="dt">exact =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>If you did not use <code>exact = TRUE</code>, the API will assume it is pattern grep and use partial matching.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get matchd the pattern for searching first 100 files</span>
p<span class="op">$</span><span class="kw">file</span>(<span class="dt">name =</span> <span class="kw">c</span>(<span class="st">"gz"</span>, <span class="st">"fastq"</span>))
<span class="co"># get all matched files from the project</span>
p<span class="op">$</span><span class="kw">file</span>(<span class="dt">name =</span> <span class="kw">c</span>(<span class="st">"gz"</span>, <span class="st">"fastq"</span>), <span class="dt">complete =</span> <span class="ot">TRUE</span>)
<span class="co"># get all files matched ucsc</span>
a<span class="op">$</span><span class="kw">public_file</span>(<span class="dt">name =</span> <span class="st">"ucsc.hg19"</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="search-by-metadata" class="section level4">
<h4 class="hasAnchor">
<a href="#search-by-metadata" class="anchor"></a>Search by metadata</h4>
<p>When you specify different metadata fields, the values use an <strong>AND</strong> operation, and when you specify the same metadata fields, the values use an <strong>OR</strong> operation.</p>
<p>To list all files in project “tengfei/demo”, that have a <code>sample_id</code> of “Sample1” <strong>OR</strong> “Sample2” <strong>AND</strong> another metadata field library_id set to “EXAMPLE”, make the following request</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p =<span class="st"> </span>a<span class="op">$</span><span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo"</span>)
p<span class="op">$</span><span class="kw">file</span>(<span class="dt">metadata =</span> <span class="kw">list</span>(<span class="dt">sample_id  =</span> <span class="st">"Sample1"</span>,
                       <span class="dt">sample_id  =</span> <span class="st">"Sample2"</span>,
                       <span class="dt">library_id =</span> <span class="st">"EXAMPLE"</span>))</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="search-by-tags" class="section level4">
<h4 class="hasAnchor">
<a href="#search-by-tags" class="anchor"></a>Search by tags</h4>
<p>Tags are more flexible than metadata. You can search with multiple tags using an <strong>OR</strong> operation.</p>
<p>This examples shows how to return all files with the tag “s1” <strong>OR</strong> “s2”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo"</span>)
p<span class="op">$</span><span class="kw">file</span>(<span class="dt">tag =</span> <span class="kw">c</span>(<span class="st">"s1"</span>, <span class="st">"s2"</span>))</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="search-by-original-task-id" class="section level4">
<h4 class="hasAnchor">
<a href="#search-by-original-task-id" class="anchor"></a>Search by original task id</h4>
<p>You can also get all files from a task. There are two ways to do it:</p>
<ol style="list-style-type: decimal">
<li>Started from the <code>Task</code> object;</li>
<li>Use the filter criteria.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># list all outputs file from a task id</span>
a<span class="op">$</span><span class="kw">task</span>(<span class="dt">id =</span> <span class="st">"53020538-6936-422f-80de-02fa65ae4b39"</span>)<span class="op">$</span><span class="kw">file</span>()

<span class="co"># OR</span>
p &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo"</span>)
p<span class="op">$</span><span class="kw">file</span>(<span class="dt">origin.task =</span> <span class="st">"53020538-6936-422f-80de-02fa65ae4b39"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="copy-a-file-or-group-of-files" class="section level3">
<h3 class="hasAnchor">
<a href="#copy-a-file-or-group-of-files" class="anchor"></a>Copy a file or group of files</h3>
<p>This call copies the specified file to a new project. Files retain their metadata when copied, but may be assigned new names in their target project.</p>
<p>Note that Controlled Data files may not be copied to Open Data projects. To make this request, you should have copy permission within the project you are copying from.</p>
<p>Let’s try to copy a file from the Public File repository. The file’s id is “561e1b33e4b0aa6ec48167d7”.</p>
<p>You must provide</p>
<ul>
<li>
<code>id</code>: file id or list/vector of files ids</li>
<li>
<code>project</code>: project id.</li>
<li>
<code>name</code> (optional):if omitted, use the same name as the original file name</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 1000G_omni2.5.b37.vcf</span>
fid  &lt;-<span class="st"> "561e1b33e4b0aa6ec48167d7"</span>
fid2 &lt;-<span class="st"> "561e1b33e4b0aa6ec48167d3"</span>
pid  &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span>id
a<span class="op">$</span><span class="kw">copyFile</span>(<span class="kw">c</span>(fid, fid2), <span class="dt">project =</span> pid)
a<span class="op">$</span><span class="kw">project</span>(<span class="dt">id =</span> pid)<span class="op">$</span><span class="kw">file</span>()</code></pre></div>
<p><strong><em>NOTE:</em></strong> To copy a group of files, you need the <code>Auth$copyFile()</code> interface. The <code>id</code> of the files in your project will be different from their <code>id</code> in the Public Files repository.</p>
<p>Alternatively, you copy a <strong>single file</strong> as shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">project</span>(<span class="st">"hello"</span>)<span class="op">$</span><span class="kw">file</span>(<span class="dt">id =</span> fid)<span class="op">$</span><span class="kw">copyTo</span>(pid)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="delete-files" class="section level3">
<h3 class="hasAnchor">
<a href="#delete-files" class="anchor"></a>Delete file(s)</h3>
<p><strong><em>Note:</em></strong> The <code>delete</code> action only works for one file at a time. Be sure your <code>file</code> call returns a single file rather than a file list.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span><span class="kw">file</span>()[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw"><a href="../reference/delete-methods.html">delete</a></span>()
## confirm the deletion
a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span><span class="kw">file</span>()</code></pre></div>
<p>You can also delete a group of files or <code>FilesList</code> object, just <strong>be careful</strong> when using this function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## return 5 files
a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span><span class="kw">file</span>(<span class="st">"phase1"</span>)
## delete all of them
<span class="kw"><a href="../reference/delete-methods.html">delete</a></span>(a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span><span class="kw">file</span>(<span class="st">"phase1"</span>))
a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span><span class="kw">file</span>(<span class="st">"phase1"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="download-files" class="section level3">
<h3 class="hasAnchor">
<a href="#download-files" class="anchor"></a>Download files</h3>
<p>To get the download information, please use the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span><span class="kw">file</span>()[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">download_url</span>()</code></pre></div>
<p>To download directly from R, use the <code>download</code> call directly from a single <code>File</code> object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fid &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span><span class="kw">file</span>()[[<span class="dv">1</span>]]<span class="op">$</span>id
a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span><span class="kw">file</span>(<span class="dt">id =</span> fid3)<span class="op">$</span><span class="kw"><a href="../reference/download-methods.html">download</a></span>(<span class="st">"~/Downloads/"</span>)</code></pre></div>
<p>I also created a <code>download</code> function for <code>FilesList</code> object to save your time, as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fls &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span><span class="kw">file</span>()
<span class="kw"><a href="../reference/download-methods.html">download</a></span>(fls, <span class="st">"~/Downloads/"</span>)</code></pre></div>
<p>To download all files from a project, use the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span><span class="kw"><a href="../reference/download-methods.html">download</a></span>(<span class="st">"~/Downloads"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="upload-files-via-api" class="section level3">
<h3 class="hasAnchor">
<a href="#upload-files-via-api" class="anchor"></a>Upload files via API</h3>
<p>Seven Bridges platforms provide a few different methods for data import:</p>
<ul>
<li>Import from FTP or HTTP with the web interface</li>
<li>The GUI uploader</li>
<li>The file upload API that you can directly call with the <code>sevenbridges</code> package</li>
<li>The command line uploader which can be involked with the <code>sevenbridges</code> package</li>
</ul>
<p>Use the API client uploader by calling the <code>project$upload</code> function to upload a file, a file list, or a folder recursively or via a manifest file.</p>
<div id="upload-single-file" class="section level4">
<h4 class="hasAnchor">
<a href="#upload-single-file" class="anchor"></a>Upload single file</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a  &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">username =</span> <span class="st">"tengfei"</span>, <span class="dt">platform =</span> <span class="st">"cgc"</span>)
fl &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"sample1.fastq"</span>, <span class="dt">package =</span> <span class="st">"sevenbridges"</span>)

(p &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/quickstart"</span>))

<span class="co"># by default load .meta for the file</span>
p<span class="op">$</span><span class="kw">upload</span>(fl, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)
<span class="co"># pass metadata</span>
p<span class="op">$</span><span class="kw">upload</span>(fl, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>, <span class="dt">metadata =</span> <span class="kw">list</span>(<span class="dt">library_id =</span> <span class="st">"testid2"</span>, <span class="dt">platform =</span> <span class="st">"Illumina x11"</span>))
<span class="co"># rename</span>
p<span class="op">$</span><span class="kw">upload</span>(fl, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>, <span class="dt">name =</span> <span class="st">"sample_new_name.fastq"</span>,
         <span class="dt">metadata =</span> <span class="kw">list</span>(<span class="dt">library_id =</span> <span class="st">"new_id"</span>))</code></pre></div>
</div>
<div id="upload-a-folder" class="section level4">
<h4 class="hasAnchor">
<a href="#upload-a-folder" class="anchor"></a>Upload a folder</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dir.ext &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="dt">package =</span> <span class="st">"sevenbridges"</span>)
<span class="kw">list.files</span>(dir.ext)
p<span class="op">$</span><span class="kw">upload</span>(dir.ext, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="upload-a-list-of-files" class="section level4">
<h4 class="hasAnchor">
<a href="#upload-a-list-of-files" class="anchor"></a>Upload a list of files</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dir.ext &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="dt">package =</span> <span class="st">"sevenbridges"</span>)
<span class="co"># enable full name</span>
fls &lt;-<span class="st"> </span><span class="kw">list.files</span>(dir.ext, <span class="dt">recursive =</span> <span class="ot">TRUE</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)
p<span class="op">$</span><span class="kw">upload</span>(fls, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)
p<span class="op">$</span><span class="kw">upload</span>(<span class="st">"~/Documents/Data/sbgtest/1000G_phase1.snps.high_confidence.b37.vcf"</span>)</code></pre></div>
</div>
<div id="upload-files-via-defined-manifest-file" class="section level4">
<h4 class="hasAnchor">
<a href="#upload-files-via-defined-manifest-file" class="anchor"></a>Upload files via defined manifest file</h4>
<p>A manifest file is a file used to define metadata values for a set of files. It can be used when uploading files to the Platform to set their metadata.The supported file format for the manifest file is CSV, i.e. comma separated values. A CSV file contains a number of rows with columns which are separated with a comma. Format of manifest file is defined in the <a href="https://docs.sevenbridges.com/docs/format-of-a-manifest-file">documentaion online</a></p>
<p>Some requirements:</p>
<ul>
<li>The first row has to contain column names which are parsed as metadata fields (e.g. “sample”“,”library“”). When it’s not customized fields, we do converstion for meta fields like “sample_id” which need to be string.</li>
<li>The first column has to contain the names of the files which will be uploaded. In case the files are not in the same directory as the manifest file, you should also include a path to the files (e.g. ../filename.fastq).</li>
</ul>
<p>We allow users to</p>
<ul>
<li>choose to upload metadata or not.</li>
<li>choose to use <code>subset</code> style to upload only part of metadata</li>
<li>choose to use <code>subset</code> style to upload only part of files with filter</li>
</ul>
<p>Please check couple examples below</p>
<pre><code>## upload all fiels and all metadatas
p$upload(manifest_file = "~/manifest.csv")
## verbal = TRUE, print single file level progress
p$upload(manifest_file = "~/manifest.csv", overwrite = TRUE, verbal = TRUE)
## manifest_metadata = FALSE doens't attach any meta
p$upload(manifest_file = "~/manifest.csv", manifest_metadata = FALSE, overwrite = TRUE)
## filter fils first, upload only files that score &lt; 0.5
p$upload(manifest_file = "~/manifest.csv", overwrite = TRUE, subset = score &lt; 0.5)
## attach all meta except "bad_field" and "sample_id"
p$upload(manifest_file = "~/manifest.csv", overwrite = TRUE,
         subset = score &lt; 0.5, select = -c(bad_field, sample_id))</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="upload-files-via-command-line-uploader" class="section level3">
<h3 class="hasAnchor">
<a href="#upload-files-via-command-line-uploader" class="anchor"></a>Upload files via command line uploader</h3>
<p>As an alternative to API file uploading, we also offer an interface in the <code>sevenbridges</code> package for uploading (possibly large) files via the Java-based command line uploader.</p>
<p>The first step is to download the command line uploader. With <code><a href="../reference/get_uploader.html">get_uploader()</a></code>, users can easily download the uploader to a local directory for a specified Seven Bridges platform, for example, the Cancer Genomics Cloud:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/get_uploader.html">get_uploader</a></span>(<span class="st">"cgc"</span>, <span class="st">"~/Downloads/"</span>)</code></pre></div>
<p>To list the available projects accessible from your account via the uploader, use <code><a href="../reference/cli_list_projects.html">cli_list_projects()</a></code>, with your authentication token for that platform and the directory containing the uploader:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cgc_token =<span class="st"> "your_cgc_token"</span>
cgc_uploader =<span class="st"> "~/Downloads/cgc-uploader/"</span>

<span class="kw"><a href="../reference/cli_list_projects.html">cli_list_projects</a></span>(
    <span class="dt">token =</span> cgc_token,
    <span class="dt">uploader =</span> cgc_uploader)</code></pre></div>
<p>The function will return a character vector containing the available projects which you could upload files to, in the form of <code>username/project-name</code>.</p>
<p>Similarly, to list all the file tags in a project via the uploader, use <code><a href="../reference/cli_list_tags.html">cli_list_tags()</a></code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cli_list_tags.html">cli_list_tags</a></span>(
    <span class="dt">token =</span> cgc_token,
    <span class="dt">uploader =</span> cgc_uploader,
    <span class="dt">project =</span> <span class="st">"username/project-name"</span>)</code></pre></div>
<p>Eventually, use <code><a href="../reference/cli_upload.html">cli_upload()</a></code> to upload local files to a project:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cli_upload.html">cli_upload</a></span>(
    <span class="dt">token =</span> cgc_token,
    <span class="dt">uploader =</span> cgc_uploader,
    <span class="dt">file =</span> <span class="st">"~/example.fastq"</span>,
    <span class="dt">project =</span> <span class="st">"username/project-name"</span>
)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="update-a-file" class="section level3">
<h3 class="hasAnchor">
<a href="#update-a-file" class="anchor"></a>Update a file</h3>
<p>You can call the <code>update()</code> function from the Files object. Using this call, the following can be updated:</p>
<ul>
<li>The file’s <code>name</code>.</li>
<li>The file’s <code>metadata</code>. The metadata is in the form of a list. Note that as this call overwrites all the metadata for a given file, please supply a full list of all the metadata for the file. Conversely, you can use the <a href="#set_metadata"><code>set_meta()</code> function</a> to patch but not overwrite the metadata for a file.</li>
</ul>
<p>If no parameters were provided, this call will just get the details of that file and update the object itself.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(fl &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo-project"</span>)<span class="op">$</span><span class="kw">file</span>(<span class="dt">name =</span> <span class="st">"sample.fastq"</span>))</code></pre></div>
<pre><code>== File ==
id : 56c7916ae4b03b56a7d7
name : sample.fastq
project : tengfei/demo-project</code></pre>
<p><strong>Show metadata</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># show metadata</span>
fl<span class="op">$</span><span class="kw">meta</span>()</code></pre></div>
<p><strong>Update meta</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fl<span class="op">$</span><span class="kw">update</span>(<span class="dt">name =</span> <span class="st">"sample.fastq"</span>,
          <span class="dt">metadata =</span> <span class="kw">list</span>(<span class="dt">new_item1 =</span> <span class="st">"item1"</span>,
                          <span class="dt">new_item2 =</span> <span class="st">"item2"</span>,
                          <span class="dt">file_extension =</span> <span class="st">"fastq"</span>))
<span class="co"># check it out</span>
fl<span class="op">$</span><span class="kw">meta</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="metadata-operations" class="section level3">
<h3 class="hasAnchor">
<a href="#metadata-operations" class="anchor"></a>Metadata operations</h3>
<p>Learn about metadata fields and their values for the relevant environment: [<a href="https://docs.sevenbridges.com/docs/metadata-on-the-seven-bridges-platform">Seven Bridges Platform</a>] [<a href="http://docs.cancergenomicscloud.org/v1.0/docs/metadata-for-private-data">CGC</a>].</p>
<p>Note that the name of a file is not the same as its ID. A file’s ID is a hexadecimal string automatically assigned to a file in a project. The file’s name is a human-readable string. For information, please see the API overview for the <a href="https://docs.sevenbridges.com/v1.0/docs/the-api">Seven Bridges Platform</a> and for the <a href="http://docs.cancergenomicscloud.org/docs/the-cgc-api">CGC</a>.</p>
<p><strong>Get metadata</strong></p>
<p>To get the metadata for a file, call the <code>meta()</code> function, as shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># meta is pulling the latest information via API</span>
fl<span class="op">$</span><span class="kw">meta</span>()
<span class="co"># field meta data saved the previous saved one</span>
fl<span class="op">$</span>metadata</code></pre></div>
<p><a name="set_metadata"></a> <strong>Set metadata</strong></p>
<p>Files from curated datasets on Seven Bridges environments have a defined set of metadata which is visible on the visual interface of each environment. However, you can also pass additional metadata for each file which is stored with your copy of the file in your project.</p>
<p>To set metadata but not overwrite all previously stored metadata, call the <code>set_meta()</code> function from the Files object. Unlike the <code>update()</code> function for the Files object, the <code>set_meta()</code> function doesn’t overwrite the metadata field. To overwrite the metadata field, use the <code>update()</code> function or pass the optional argument <code>overwrite = TRUE</code> for the <code>set_meta()</code> call.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fl<span class="op">$</span><span class="kw">set_meta</span>(<span class="dt">new_item3 =</span> <span class="st">"item3"</span>)
fl
<span class="co"># oops it removed rest of the meta</span>
fl<span class="op">$</span><span class="kw">set_meta</span>(<span class="dt">new_item4 =</span> <span class="st">"item4"</span>, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)
fl</code></pre></div>
<p><strong>Check details of each metadata field</strong></p>
<p>You can use the <code><a href="../reference/Metadata.html">Metadata()</a></code> constructor to check the details of each metadata field. Simply call the function (name of the metadata) to display descriptions and enumerated itemts. Please pay attention to the <code>suggested_values</code> field.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># check which schema we have</span>
<span class="kw"><a href="../reference/Metadata.html">Metadata</a></span>()<span class="op">$</span><span class="kw">show</span>(<span class="dt">full =</span> <span class="ot">TRUE</span>)
<span class="co"># check details for each, play with it</span>
<span class="kw"><a href="../reference/Metadata.html">platform</a></span>()
<span class="kw"><a href="../reference/Metadata.html">paired_end</a></span>()
<span class="kw"><a href="../reference/Metadata.html">quality_scale</a></span>()</code></pre></div>
<p>As you can see, some metadata fields have suggested values. To construct the metadata, use <code><a href="../reference/Metadata.html">Metadata()</a></code> directly to pass the metadata fields and their values directly into the call. The call will perform the validation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/Metadata.html">Metadata</a></span>(<span class="dt">platform      =</span> <span class="st">"Affymetrix SNP Array 6.0"</span>,
         <span class="dt">paired_end    =</span> <span class="dv">1</span>,
         <span class="dt">quality_scale =</span> <span class="st">"sanger"</span>,
         <span class="dt">new_item      =</span> <span class="st">"new test"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="tag-files" class="section level3">
<h3 class="hasAnchor">
<a href="#tag-files" class="anchor"></a>Tag file(s)</h3>
<p>You can tag your files with keywords or strings to make it easier to identify and organize files. Tags are different from metadata, and are more convenient and visible from the files list on the visual interface.</p>
<p><strong>Add a new tag</strong></p>
<p>To add a new tag, call the <code>obj$add_tag()</code> method for the File object with a single tag string or a list or vector of tags.</p>
<p><strong>Overwrite the tags for a file</strong></p>
<p>To completely overwrite the tags for a file, use the <code>obj$set_tag()</code> method, which contains the default argument <code>overwrite = TRUE</code>.</p>
<p>Let’s use a file called <code>sample.bam</code> and play with its tags.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p  &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/s3tutorial"</span>)
fl &lt;-<span class="st"> </span>p<span class="op">$</span><span class="kw">file</span>(<span class="st">"sample.bam"</span>, <span class="dt">exact =</span> <span class="ot">TRUE</span>)
<span class="co"># show tags for single file</span>
fl<span class="op">$</span><span class="kw">tag</span>()
<span class="co"># add new tags</span>
fl<span class="op">$</span><span class="kw"><a href="../reference/tag-methods.html">add_tag</a></span>(<span class="st">"new tag"</span>)
<span class="co"># equavilent to</span>
fl<span class="op">$</span><span class="kw"><a href="../reference/tag-methods.html">set_tag</a></span>(<span class="st">"new tag 2"</span>, <span class="dt">overwrite =</span> <span class="ot">FALSE</span>)
<span class="co"># set tags to overwrite existing</span>
x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">"this"</span>, <span class="st">"is"</span>, <span class="dv">1234</span>)
fl<span class="op">$</span><span class="kw"><a href="../reference/tag-methods.html">set_tag</a></span>(x)
<span class="co"># filter by tags</span>
p<span class="op">$</span><span class="kw">file</span>(<span class="dt">tag =</span> <span class="kw">c</span>(<span class="st">"1234"</span>, <span class="st">"new"</span>))
p<span class="op">$</span><span class="kw">file</span>(<span class="dt">tag =</span> <span class="kw">list</span>(<span class="st">"1234"</span>, <span class="st">"new"</span>))
p<span class="op">$</span><span class="kw">file</span>(<span class="dt">tag =</span> <span class="st">"1234"</span>)</code></pre></div>
<p>Below, find convenient methods for <code>FilesList</code>. Let’s add the tag “s1” to a group files matching “Sample1” and add the tag “s2” to a group of files that match “s2”. Then, we will filter by these tags to obtain specific files.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># work on a group of files</span>
<span class="co"># add tag "s2" to a group of files named with "Sample2" in it</span>
fl2 &lt;-<span class="st"> </span>p<span class="op">$</span><span class="kw">file</span>(<span class="st">"Sample2"</span>)
<span class="kw"><a href="../reference/tag-methods.html">add_tag</a></span>(fl2, <span class="st">"s2"</span>)
<span class="co"># add tag "s2" to a group of files named with "Sample1" in it</span>
fl1 &lt;-<span class="st"> </span>p<span class="op">$</span><span class="kw">file</span>(<span class="st">"Sample1"</span>)
<span class="kw"><a href="../reference/tag-methods.html">add_tag</a></span>(fl1, <span class="st">"s1"</span>)
<span class="co"># filter by tag s1 or s2</span>
p<span class="op">$</span><span class="kw">file</span>(<span class="dt">tag =</span> <span class="st">"s1"</span>)
p<span class="op">$</span><span class="kw">file</span>(<span class="dt">tag =</span> <span class="st">"s2"</span>)
<span class="co"># get files tagged with s2 and 1234</span>
p<span class="op">$</span><span class="kw">file</span>(<span class="dt">tag =</span> <span class="kw">list</span>(<span class="st">"s2"</span>, <span class="st">"s1"</span>))</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="app" class="section level2">
<h2 class="hasAnchor">
<a href="#app" class="anchor"></a>App</h2>
<p>All Seven Bridges environments support the <a href="http://www.commonwl.org/">Common Workflow Language (CWL)</a> natively to allow for reproducible and portable workflows and tools. In this section, we will work with apps, including tools and workflows, via the API using the <code>sevenbridges</code> R package.</p>
<div align="right">
<a href="#top">top</a>
</div>
<div id="list-all-apps" class="section level3">
<h3 class="hasAnchor">
<a href="#list-all-apps" class="anchor"></a>List all apps</h3>
<p>This call lists all the apps available to you.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">app</span>()
<span class="co"># or show details</span>
a<span class="op">$</span><span class="kw">app</span>(<span class="dt">detail =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><strong>Search for an app by name</strong></p>
<p>To search for a specific app by its name, pass a pattern for the <code>name</code> argument or provide a unique <code>id</code> as shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># pattern match</span>
a<span class="op">$</span><span class="kw">app</span>(<span class="dt">name =</span> <span class="st">"STAR"</span>)
<span class="co"># unique id</span>
aid &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">app</span>()[[<span class="dv">1</span>]]<span class="op">$</span>id
aid
a<span class="op">$</span><span class="kw">app</span>(<span class="dt">id =</span> aid)
<span class="co"># get a specific revision from an app</span>
a<span class="op">$</span><span class="kw">app</span>(<span class="dt">id =</span> aid, <span class="dt">revision =</span> <span class="dv">0</span>)</code></pre></div>
<p><strong>List all apps in a project</strong></p>
<p>To list all apps belonging to a specific project, use the <code>project</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># my favorite, always</span>
a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span><span class="kw">app</span>()

<span class="co"># or alternatviely</span>
pid &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span>id
a<span class="op">$</span><span class="kw">app</span>(<span class="dt">project =</span> pid)</code></pre></div>
<p><strong>List all public apps</strong></p>
<p>To list all public apps, use the <code>visibility</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># show 100 items from public</span>
x &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">app</span>(<span class="dt">visibility =</span> <span class="st">"public"</span>)
<span class="kw">length</span>(x)
x &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">app</span>(<span class="dt">visibility =</span> <span class="st">"public"</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)
<span class="kw">length</span>(x)
x &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">app</span>(<span class="dt">project =</span> <span class="st">"tengfei/helloworld"</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)
<span class="kw">length</span>(x)
a<span class="op">$</span><span class="kw">app</span>(<span class="dt">visibility =</span> <span class="st">"public"</span>, <span class="dt">limit =</span> <span class="dv">5</span>, <span class="dt">offset =</span> <span class="dv">150</span>)</code></pre></div>
<p><strong>Search through all public apps in all locations</strong></p>
<p>To search for a public app cross all locations, make the following call. Note that this may take a bit of time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">app</span>(<span class="st">"STAR"</span>, <span class="dt">visibility =</span> <span class="st">"public"</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="copy-an-app" class="section level3">
<h3 class="hasAnchor">
<a href="#copy-an-app" class="anchor"></a>Copy an app</h3>
<p>This call copies the specified app to a specified project. The app should be one in a project that you can access, either an app which has been uploaded by a project member or a publicly availble app which has been copied to the project.</p>
<p>This call requires the following two arguments:</p>
<ul>
<li>
<code>project</code>: include the project id</li>
<li>
<code>name</code> (optional): use this field to optionally re-name your app</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">aid &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">public_app</span>()[[<span class="dv">1</span>]]<span class="op">$</span>id
a<span class="op">$</span><span class="kw">copy_app</span>(aid, <span class="dt">project =</span> pid, <span class="dt">name =</span> <span class="st">"copy-rename-test"</span>)
<span class="co"># check if it is copied</span>
a<span class="op">$</span><span class="kw">app</span>(<span class="dt">project =</span> pid)</code></pre></div>
<p>You can also copy directly from the app object, as shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">app &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">public_app</span>(<span class="dt">id =</span> <span class="st">"admin/sbg-public-data/rna-seq-alignment-star"</span>)
app<span class="op">$</span><span class="kw">copy_to</span>(<span class="dt">project =</span> <span class="st">"tengfei/api-testing"</span>,
            <span class="dt">name =</span> <span class="st">"copy of star"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="get-an-apps-cwl-description" class="section level3">
<h3 class="hasAnchor">
<a href="#get-an-apps-cwl-description" class="anchor"></a>Get an app’s CWL description</h3>
<p>This call returns the raw CWL of a specific app, including its raw CWL. The call differs from the call to GET details of an app in that it returns a JSON object that is the CWL.</p>
<p>The app should be one in a project that you can access, either an app which has been uploaded by a project member or a publicly availble app which has been copied to the project.</p>
<p>To get a specific revision, pass the <code>revision</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ap &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">app</span>(<span class="dt">visibility =</span> <span class="st">"public"</span>)[[<span class="dv">1</span>]]
a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span><span class="kw">app</span>(<span class="st">"index"</span>)
<span class="co"># get a specific revision</span>
a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span><span class="kw">app</span>(<span class="st">"index"</span>, <span class="dt">revision =</span> <span class="dv">0</span>)</code></pre></div>
<p>Coming soon: converting apps to CWL objects</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="add-cwl-as-an-app" class="section level3">
<h3 class="hasAnchor">
<a href="#add-cwl-as-an-app" class="anchor"></a>Add CWL as an app</h3>
<p>To add a CWL object as an app, use the <code>app_add</code> function call for a <code>Project</code> object. The following two parameters are required:</p>
<ul>
<li>
<code>short_name</code>: Project short names are based on the name you give to a project when you create it. Learn more about project short names on the <a href="https://docs.sevenbridges.com/v1.0/docs/the-api#section-project-short-names">Seven Bridges Platform</a> or the <a href="http://docs.cancergenomicscloud.org/v1.0/docs/the-cgc-api#section-project-short-names">CGC</a>.</li>
<li>
<code>filename</code>: The name of the JSON file containing the CWL.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cwl.fl &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"bam_index.json"</span>, <span class="dt">package =</span> <span class="st">"sevenbridges"</span>)
a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span><span class="kw">app_add</span>(<span class="dt">short_name =</span> <span class="st">"new_bam_index_app"</span>, <span class="dt">filename =</span> cwl.fl)
a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span><span class="kw">app_add</span>(<span class="dt">short_name =</span> <span class="st">"new_bam_index_app"</span>, <span class="dt">revision =</span> <span class="dv">2</span>, <span class="dt">filename =</span> cwl.fl)</code></pre></div>
<p>Note: If you provide the same <code>short_name</code>, this will add a new revision.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="describe-cwl-in-r-directly" class="section level3">
<h3 class="hasAnchor">
<a href="#describe-cwl-in-r-directly" class="anchor"></a>Describe CWL in R directly</h3>
<p>This is introduced in another vignette (<code><a href="../articles/apps.html">vignette("apps", "sevenbridges")</a></code>).</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="create-test-or-keep-previous-test-for-tool" class="section level3">
<h3 class="hasAnchor">
<a href="#create-test-or-keep-previous-test-for-tool" class="anchor"></a>Create test or keep previous test for Tool</h3>
<p>On sevenbridges platform, when you create or update your tools in the GUI, there is a test tab allow users to tweak the parameters and see what it looks like in your commandline simulatd terminal. To do this via R when you push your Tool object to your project, you need to provide “sbg:job” information like the example shown below</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rbx &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Tool-class.html">Tool</a></span>(<span class="dt">id =</span> <span class="st">"runif"</span>,
            <span class="dt">label =</span> <span class="st">"Random number generator"</span>,
            <span class="dt">hints =</span> <span class="kw"><a href="../reference/requirements.html">requirements</a></span>(<span class="kw"><a href="../reference/requirements.html">docker</a></span>(<span class="dt">pull =</span> <span class="st">"tengfei/runif"</span>),
                                 <span class="kw"><a href="../reference/requirements.html">cpu</a></span>(<span class="dv">1</span>), <span class="kw"><a href="../reference/requirements.html">mem</a></span>(<span class="dv">2000</span>)),
            <span class="dt">baseCommand =</span> <span class="st">"runif.R"</span>,
            <span class="dt">inputs =</span> in.lst,
            <span class="dt">outputs =</span> out.lst,
            <span class="st">'sbg:job'</span> =<span class="st"> </span><span class="kw">list</span>(<span class="dt">allocatedResources =</span> <span class="kw">list</span>(<span class="dt">mem =</span> <span class="dv">9000</span>, <span class="dt">cpu =</span> <span class="dv">1</span>),
                             <span class="dt">inputs =</span> <span class="kw">list</span>(<span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">150</span>)))
p<span class="op">$</span><span class="kw">app_add</span>(<span class="st">"random"</span>, rbx)</code></pre></div>
<p>Or if you have created a test info on the platform or previously pushed one, and you want to keep the previous test setup. We provide a arguments called <code>keep_test</code> to allow you keep the previous revision’s test information.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rbx &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Tool-class.html">Tool</a></span>(<span class="dt">id =</span> <span class="st">"runif"</span>,
            <span class="dt">label =</span> <span class="st">"Random number generator"</span>,
            <span class="dt">hints =</span> <span class="kw"><a href="../reference/requirements.html">requirements</a></span>(<span class="kw"><a href="../reference/requirements.html">docker</a></span>(<span class="dt">pull =</span> <span class="st">"tengfei/runif"</span>),
                                 <span class="kw"><a href="../reference/requirements.html">cpu</a></span>(<span class="dv">1</span>), <span class="kw"><a href="../reference/requirements.html">mem</a></span>(<span class="dv">2000</span>)),
            <span class="dt">baseCommand =</span> <span class="st">"runif.R"</span>,
            <span class="dt">inputs =</span> in.lst,
            <span class="dt">outputs =</span> out.lst)
p<span class="op">$</span><span class="kw">app_add</span>(<span class="st">"random"</span>, rbx, <span class="dt">keep_test =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="task" class="section level2">
<h2 class="hasAnchor">
<a href="#task" class="anchor"></a>Task</h2>
<div id="list-tasks" class="section level3">
<h3 class="hasAnchor">
<a href="#list-tasks" class="anchor"></a>List tasks</h3>
<p>This call returns a list of tasks that you can access. You are able to filter tasks by status.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># all tasks</span>
a<span class="op">$</span><span class="kw">task</span>()
<span class="co"># filter</span>
a<span class="op">$</span><span class="kw">task</span>(<span class="dt">status =</span> <span class="st">"completed"</span>)
a<span class="op">$</span><span class="kw">task</span>(<span class="dt">status =</span> <span class="st">"running"</span>)</code></pre></div>
<p>To list all tasks in a project, use the following.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># a better way</span>
a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span><span class="kw">task</span>()

<span class="co"># alternatively</span>
pid &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span>id
a<span class="op">$</span><span class="kw">task</span>(<span class="dt">project =</span> pid)</code></pre></div>
<p>To list all tasks with details, pass <code>detail = TRUE</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p<span class="op">$</span><span class="kw">task</span>(<span class="dt">id =</span> <span class="st">"your task id here"</span>, <span class="dt">detail =</span> <span class="ot">TRUE</span>)
p<span class="op">$</span><span class="kw">task</span>(<span class="dt">detail =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>To list a batch task using the <code>parent</code> parameter, pass the batch parent task id.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo"</span>)
p<span class="op">$</span><span class="kw">task</span>(<span class="dt">id =</span> <span class="st">"2e1ebed1-c53e-4373-870d-4732acacbbbb"</span>)
p<span class="op">$</span><span class="kw">task</span>(<span class="dt">parent =</span> <span class="st">"2e1ebed1-c53e-4373-870d-4732acacbbbb"</span>)
p<span class="op">$</span><span class="kw">task</span>(<span class="dt">parent =</span> <span class="st">"2e1ebed1-c53e-4373-870d-4732acacbbbb"</span>, <span class="dt">status =</span> <span class="st">"completed"</span>)
p<span class="op">$</span><span class="kw">task</span>(<span class="dt">parent =</span> <span class="st">"2e1ebed1-c53e-4373-870d-4732acacbbbb"</span>, <span class="dt">status =</span> <span class="st">"draft"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="create-a-draft-task" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-draft-task" class="anchor"></a>Create a draft task</h3>
<p>To create a draft task, you need to call the <code>task_add</code> function from the Project object. And you need to pass the following arguments:</p>
<ul>
<li>
<code>name</code>: The name for this task</li>
<li>
<code>description</code> (optional): A description for this task</li>
<li>
<code>app</code>: The app id</li>
<li>
<code>inputs</code>: A list of inputs for this task</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># push an app first</span>
fl.runif &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"runif.json"</span>, <span class="dt">package =</span> <span class="st">"sevenbridges"</span>)
a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span><span class="kw">app_add</span>(<span class="st">"runif_draft"</span>, fl.runif)
runif_id &lt;-<span class="st"> "tengfei/demo-project/runif_draft"</span>
<span class="co"># create a draft task</span>
a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span><span class="kw">task_add</span>(<span class="dt">name =</span> <span class="st">"Draft runif 3"</span>,
                           <span class="dt">description =</span> <span class="st">"Description for runif 3"</span>,
                           <span class="dt">app =</span> runif_id,
                           <span class="dt">inputs =</span> <span class="kw">list</span>(<span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">10</span>))
<span class="co"># confirm</span>
a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span><span class="kw">task</span>(<span class="dt">status =</span> <span class="st">"draft"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="modify-a-task" class="section level3">
<h3 class="hasAnchor">
<a href="#modify-a-task" class="anchor"></a>Modify a task</h3>
<p>Call the <code>update</code> function from a Task object to update the following:</p>
<ul>
<li><code>name</code></li>
<li><code>description</code></li>
<li>
<code>inputs</code> list. Note that you can only update the items you provided.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get the single task you want to update</span>
tsk &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">project</span>(<span class="st">"demo"</span>)<span class="op">$</span><span class="kw">task</span>(<span class="st">"Draft runif 3"</span>)
tsk
tsk<span class="op">$</span><span class="kw">update</span>(<span class="dt">name =</span> <span class="st">"Draft runif update"</span>,
           <span class="dt">description =</span> <span class="st">"draft 2"</span>,
           <span class="dt">inputs =</span> <span class="kw">list</span>(<span class="dt">max =</span> <span class="dv">100</span>))
<span class="co"># alternative way to check all inputs</span>
tsk<span class="op">$</span><span class="kw">getInputs</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="run-a-task-1" class="section level3">
<h3 class="hasAnchor">
<a href="#run-a-task-1" class="anchor"></a>Run a task</h3>
<p>This call runs (“executes”) the specified task. Only tasks with a “DRAFT” status may be run.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tsk<span class="op">$</span><span class="kw">run</span>()
<span class="co"># run update without information just return latest information</span>
tsk<span class="op">$</span><span class="kw">update</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
<p><a name="hook"></a> ### Monitor a running task and set the hook function</p>
<p>To monitor a running task, call <code>monitor</code> from a Task object.</p>
<ul>
<li>First argument, set the interval time to check the status</li>
<li>Rest arguments might be used for hook function</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tsk<span class="op">$</span><span class="kw">monitor</span>()</code></pre></div>
<p>Get and set default a hook function for task status. Currently, failed tasks will break the monitoring.</p>
<p>Note: Hook function has to return <code>TRUE</code> (break monitoring) or <code>FALSE</code> (continuing) in the end.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/TaskHook.html">getTaskHook</a></span>(<span class="st">"completed"</span>)
<span class="kw"><a href="../reference/TaskHook.html">getTaskHook</a></span>(<span class="st">"draft"</span>)
<span class="kw"><a href="../reference/TaskHook.html">setTaskHook</a></span>(<span class="st">"draft"</span>, <span class="cf">function</span>(){<span class="kw">message</span>(<span class="st">"never happens"</span>); <span class="kw">return</span>(<span class="ot">TRUE</span>)})
<span class="kw"><a href="../reference/TaskHook.html">getTaskHook</a></span>(<span class="st">"draft"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="abort-a-running-task" class="section level3">
<h3 class="hasAnchor">
<a href="#abort-a-running-task" class="anchor"></a>Abort a running task</h3>
<p>This call aborts the specified task. Only tasks whose status is “RUNNING” may be aborted.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># abort</span>
tsk<span class="op">$</span><span class="kw">abort</span>()
<span class="co"># check</span>
tsk<span class="op">$</span><span class="kw">update</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="delete-a-task" class="section level3">
<h3 class="hasAnchor">
<a href="#delete-a-task" class="anchor"></a>Delete a task</h3>
<p>Note that you can only delete DRAFT tasks, not running tasks.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tsklst &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">task</span>(<span class="dt">status =</span> <span class="st">"draft"</span>)
<span class="co"># delete a single task</span>
tsklst[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw"><a href="../reference/delete-methods.html">delete</a></span>()
<span class="co"># confirm</span>
a<span class="op">$</span><span class="kw">task</span>(<span class="dt">status =</span> <span class="st">"draft"</span>)
<span class="co"># delete a list of tasks</span>
<span class="kw"><a href="../reference/delete-methods.html">delete</a></span>(tsklst)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="download-all-files-from-a-completed-task" class="section level3">
<h3 class="hasAnchor">
<a href="#download-all-files-from-a-completed-task" class="anchor"></a>Download all files from a completed task</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tsk<span class="op">$</span><span class="kw"><a href="../reference/download-methods.html">download</a></span>(<span class="st">"~/Downloads"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="run-task-in-batch-mode" class="section level3">
<h3 class="hasAnchor">
<a href="#run-task-in-batch-mode" class="anchor"></a>Run task in batch mode</h3>
<p>To run task in batch mode, (check <code><a href="../reference/batch.html">?batch</a></code>) for more details. The code below is a mock.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># batch by items</span>
(tsk &lt;-<span class="st"> </span>p<span class="op">$</span><span class="kw">task_add</span>(<span class="dt">name =</span> <span class="st">"RNA DE report new batch 2"</span>,
                   <span class="dt">description =</span> <span class="st">"RNA DE analysis report"</span>,
                   <span class="dt">app =</span> rna.app<span class="op">$</span>id,
                   <span class="dt">batch =</span> <span class="kw"><a href="../reference/batch.html">batch</a></span>(<span class="dt">input =</span> <span class="st">"bamfiles"</span>),
                   <span class="dt">inputs =</span> <span class="kw">list</span>(<span class="dt">bamfiles =</span> bamfiles.in,
                                 <span class="dt">design =</span> design.in,
                                 <span class="dt">gtffile =</span> gtf.in)))

<span class="co"># batch by metadata, input files has to have metadata fields specified</span>
(tsk &lt;-<span class="st"> </span>p<span class="op">$</span><span class="kw">task_add</span>(<span class="dt">name =</span> <span class="st">"RNA DE report new batch 3"</span>,
                   <span class="dt">description =</span> <span class="st">"RNA DE analysis report"</span>,
                   <span class="dt">app =</span> rna.app<span class="op">$</span>id,
                   <span class="dt">batch =</span> <span class="kw"><a href="../reference/batch.html">batch</a></span>(<span class="dt">input =</span> <span class="st">"fastq"</span>,
                                 <span class="kw">c</span>(<span class="st">"metadata.sample_id"</span>, <span class="st">"metadata.library_id"</span>)),
                   <span class="dt">inputs =</span> <span class="kw">list</span>(<span class="dt">bamfiles =</span> bamfiles.in,
                                 <span class="dt">design =</span> design.in,
                                 <span class="dt">gtffile =</span> gtf.in)))</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="volumes" class="section level2">
<h2 class="hasAnchor">
<a href="#volumes" class="anchor"></a>Volumes</h2>
<p>Cloud storage providers come with their own interfaces, features and terminology. At a certain level, though, they all view resources as data objects organized in repositories. Authentication and operations are commonly defined on those objects and repositories, and while each cloud provider might call these things different names and apply different parameters to them, their basic behavior is the same.</p>
<p>Seven Bridges environments mediate access to these repositories using volumes. A volume is associated with a particular cloud storage repository that you have enabled Seven Bridges to read from (and, optionally, to write to). Currently, volumes may be created using two types of cloud storage repository: Amazon Web Services’ (AWS) S3 buckets and Google Cloud Storage (GCS) buckets.</p>
<p>A volume enables you to treat the cloud repository associated with it as external storage. You can ‘import’ files from the volume to your Seven Bridges environment to use them as inputs for computation. Similarly, you can write files from the Seven Bridges environment to your cloud storage by ‘exporting’ them to your volume.</p>
<p>Learn more about volumes on the <a href="https://docs.sevenbridges.com/docs/connecting-cloud-storage-overview">Seven Bridges Platform</a> and the <a href="http://docs.cancergenomicscloud.org/docs/connect-cloud-storage-overview">CGC</a>.</p>
<div id="create-a-volume" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-volume" class="anchor"></a>Create a volume</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">user =</span> <span class="st">"tengfei"</span>, <span class="dt">platform =</span> <span class="st">"aws-us"</span>)
a<span class="op">$</span><span class="kw">add_volume</span>(<span class="dt">name   =</span> <span class="st">"tutorial_volume"</span>,
             <span class="dt">type   =</span> <span class="st">"s3"</span>,
             <span class="dt">bucket =</span> <span class="st">"tengfei-demo"</span>,
             <span class="dt">prefix =</span> <span class="st">""</span>,
             <span class="dt">access_key_id     =</span> <span class="st">"AKIAJQENSIA4DJQNZO3A"</span>,
             <span class="dt">secret_access_key =</span> <span class="st">"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"</span>,
             <span class="dt">sse_algorithm     =</span> <span class="st">"AES256"</span>,
             <span class="dt">access_mode       =</span> <span class="st">"RW"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="list-and-search-all-volumes" class="section level3">
<h3 class="hasAnchor">
<a href="#list-and-search-all-volumes" class="anchor"></a>List and search all volumes</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># list all volume</span>
a<span class="op">$</span><span class="kw">volume</span>()
<span class="co"># get unique volume by id</span>
a<span class="op">$</span><span class="kw">volume</span>(<span class="dt">id =</span> <span class="st">"tengfei/tengfei_demo"</span>)
<span class="co"># partial search by name</span>
a<span class="op">$</span><span class="kw">volume</span>(<span class="dt">name =</span> <span class="st">"demo"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="get-a-volumes-detail" class="section level3">
<h3 class="hasAnchor">
<a href="#get-a-volumes-detail" class="anchor"></a>Get a volume’s detail</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">volume</span>()
v[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">detail</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="delete-volume" class="section level3">
<h3 class="hasAnchor">
<a href="#delete-volume" class="anchor"></a>Delete volume</h3>
<p>This call deletes a volume you’ve created to refer to storage on Amazon Web Services or Google Cloud Storage.</p>
<p>Note that any files you’ve imported from your volume onto a Seven Bridges environment, known as an alias, will no longer be usable. If a new volume is created with the same volume_id as the deleted volume, aliases will point to files on the newly created volume instead (if those exist).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a<span class="op">$</span><span class="kw">volume</span>(<span class="dt">id =</span> <span class="st">"tengfei/tengfei_demo"</span>)<span class="op">$</span><span class="kw"><a href="../reference/delete-methods.html">delete</a></span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="import-file-from-volume-to-project" class="section level3">
<h3 class="hasAnchor">
<a href="#import-file-from-volume-to-project" class="anchor"></a>Import file from volume to project</h3>
<p>This call imports a file from volume to your project.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">volume</span>(<span class="dt">id =</span> <span class="st">"tengfei/tutorial_volume"</span>)
res &lt;-<span class="st"> </span>v<span class="op">$</span><span class="kw">import</span>(<span class="dt">location =</span>  <span class="st">"A-RNA-File.bam.bai"</span>,
                <span class="dt">project =</span> <span class="st">"tengfei/s3tutorial"</span>,
                <span class="dt">name =</span> <span class="st">"new.bam.bai"</span>,
                <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)

<span class="co"># get job status update</span>
<span class="co"># state will be "COMPLETED" when it's finished, otherwise "PENDING"</span>
v<span class="op">$</span><span class="kw">get_import_job</span>(res<span class="op">$</span>id)
v</code></pre></div>
</div>
<div id="export-file-from-project-to-volume" class="section level3">
<h3 class="hasAnchor">
<a href="#export-file-from-project-to-volume" class="anchor"></a>Export file from project to volume</h3>
<p><strong>Important</strong> :</p>
<ul>
<li>The file selected for export must not be a public file or an alias. Aliases are objects stored in your cloud storage bucket which have been made available on a Seven Bridges environment. The volume you are exporting to must be configured for read-write access. To do this, set the access_mode parameter to RW when creating or modifying a volume.</li>
<li>If this call is successful, the original project file will become an alias to the newly exported object on the volume. The source file will be deleted from the Seven Bridges environment and, if no more copies of this file exist, it will no longer count towards your total storage price on the Seven Bridges environment.</li>
</ul>
<p>When testing please update your file in a project.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res &lt;-<span class="st"> </span>v<span class="op">$</span><span class="kw">export</span>(<span class="dt">file =</span> <span class="st">"579fb1c9e4b08370afe7903a"</span>,
                <span class="dt">volume =</span> <span class="st">"tengfei/tutorial_volume"</span>,
                <span class="dt">location =</span> <span class="st">""</span>,  <span class="co"># when "" use old name</span>
                <span class="dt">sse_algorithm =</span> <span class="st">"AES256"</span>)
<span class="co"># get job status update</span>
<span class="co"># state will be "COMPLETED" when it's finished other wise "PENDING"</span>
v<span class="op">$</span><span class="kw">get_export_job</span>(res<span class="op">$</span>id)
v</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="public-files-and-apps" class="section level2">
<h2 class="hasAnchor">
<a href="#public-files-and-apps" class="anchor"></a>Public Files and Apps</h2>
<p>Seven Bridges hosts publicly accessible files and apps on its environments. The <code>sevenbridges</code> package provides two easy function calls from the Authentication object to search for and copy files and apps to a project.</p>
<div id="public-files" class="section level3">
<h3 class="hasAnchor">
<a href="#public-files" class="anchor"></a>Public files</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># list the first 100 files</span>
a<span class="op">$</span><span class="kw">public_file</span>()
<span class="co"># list by offset and limit</span>
a<span class="op">$</span><span class="kw">public_file</span>(<span class="dt">offset =</span> <span class="dv">100</span>, <span class="dt">limit =</span> <span class="dv">100</span>)
<span class="co"># simply list everything!</span>
a<span class="op">$</span><span class="kw">public_file</span>(<span class="dt">complete =</span> <span class="ot">TRUE</span>)
<span class="co"># get exact file by id</span>
a<span class="op">$</span><span class="kw">public_file</span>(<span class="dt">id =</span> <span class="st">"5772b6f0507c175267448700"</span>)
<span class="co"># get exact file by name with exact = TRUE</span>
a<span class="op">$</span><span class="kw">public_file</span>(<span class="dt">name =</span> <span class="st">"G20479.HCC1143.2.converted.pe_1_1Mreads.fastq"</span>, <span class="dt">exact =</span> <span class="ot">TRUE</span>)
<span class="co"># with exact = FALSE by default search by name pattern</span>
a<span class="op">$</span><span class="kw">public_file</span>(<span class="dt">name =</span> <span class="st">"fastq"</span>)
a<span class="op">$</span><span class="kw">public_file</span>(<span class="dt">name =</span> <span class="st">"G20479.HCC1143.2.converted.pe_1_1Mreads.fastq"</span>)</code></pre></div>
<p>Public files are hosted in the project called <code>admin/sbg-public-data</code>, and you can alternatively use the <code>file</code> request to get files you need.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="public-apps" class="section level3">
<h3 class="hasAnchor">
<a href="#public-apps" class="anchor"></a>Public apps</h3>
<p>For public apps, there are similar API calls.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># list for 100 apps</span>
a<span class="op">$</span><span class="kw">public_app</span>()
<span class="co"># list by offset and limit</span>
a<span class="op">$</span><span class="kw">public_app</span>(<span class="dt">offset =</span> <span class="dv">100</span>, <span class="dt">limit =</span> <span class="dv">50</span>)
<span class="co"># search by id</span>
a<span class="op">$</span><span class="kw">public_app</span>(<span class="dt">id =</span> <span class="st">"admin/sbg-public-data/control-freec-8-1/12"</span>)
<span class="co"># search by name in ALL apps</span>
a<span class="op">$</span><span class="kw">public_app</span>(<span class="dt">name =</span> <span class="st">"STAR"</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)
<span class="co"># search by name with exact match</span>
a<span class="op">$</span><span class="kw">public_app</span>(<span class="dt">name =</span> <span class="st">"Control-FREEC"</span>, <span class="dt">exact =</span> <span class="ot">TRUE</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="get-raw-response-from-httr" class="section level2">
<h2 class="hasAnchor">
<a href="#get-raw-response-from-httr" class="anchor"></a>Get Raw Response from httr</h2>
<p>In the easy API, we return an object which contains the raw response from <code>httr</code> as a field. You can either call <code><a href="../reference/response-methods.html">response()</a></code> on that object or just use the field as is.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="batch-operation-on-projectfilestasks" class="section level2">
<h2 class="hasAnchor">
<a href="#batch-operation-on-projectfilestasks" class="anchor"></a>Batch Operation on Project/Files/Tasks</h2>
<p>Currently, users have to use <code>lapply</code> to do those operations themselves. It’s a simple implementation.</p>
<p>In this package, we implement <code>delete</code> and <code>download</code> for some objects like task, project, or file.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="cheatsheet" class="section level1">
<h1 class="hasAnchor">
<a href="#cheatsheet" class="anchor"></a>Cheatsheet</h1>
<p>Quick cheat sheet (in progress)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Authentication
<span class="kw">getToken</span>()
a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">token =</span> token)
a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">token =</span> token, <span class="dt">platform =</span> <span class="st">"cgc"</span>)
a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">from =</span> <span class="st">"env"</span>)
a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">from =</span> <span class="st">"file"</span>, <span class="dt">profile_name =</span> <span class="st">"aws-us-tengfei"</span>)

## list API
a<span class="op">$</span><span class="kw"><a href="../reference/api.html">api</a></span>()

## Rate limits
a<span class="op">$</span><span class="kw">rate_limit</span>()

## Users
a<span class="op">$</span><span class="kw">user</span>()
a<span class="op">$</span><span class="kw">user</span>(<span class="st">"tengfei"</span>)

## billing
a<span class="op">$</span><span class="kw">billing</span>()
a<span class="op">$</span><span class="kw">billing</span>(<span class="dt">id =</span> , <span class="dt">breakdown =</span> <span class="ot">TRUE</span>)
a<span class="op">$</span><span class="kw">invoice</span>()
a<span class="op">$</span><span class="kw">invoice</span>(<span class="dt">id =</span> <span class="st">"fake_id"</span>)

## Project
### create new project
a<span class="op">$</span><span class="kw">project_new</span>(<span class="dt">name =</span> , <span class="dt">billing_group_id =</span> , <span class="dt">description =</span> )
### list all project owned by you
a<span class="op">$</span><span class="kw">project</span>()
a<span class="op">$</span><span class="kw">project</span>(<span class="dt">owner =</span> <span class="st">"yintengfei"</span>)
### partial match
p &lt;-<span class="st"> </span>a<span class="op">$</span><span class="kw">project</span>(<span class="dt">name =</span> , <span class="dt">id =</span> , <span class="dt">exact =</span> <span class="ot">TRUE</span>)
### delete
p<span class="op">$</span><span class="kw"><a href="../reference/delete-methods.html">delete</a></span>()
### update
p<span class="op">$</span><span class="kw">update</span>(<span class="dt">name =</span> , <span class="dt">description =</span> )
### members
p<span class="op">$</span><span class="kw">member</span>()
p<span class="op">$</span><span class="kw">member_add</span>(<span class="dt">username =</span> )
p<span class="op">$</span><span class="kw">member</span>(<span class="dt">username =</span> )<span class="op">$</span><span class="kw">update</span>(<span class="dt">write =</span> , <span class="dt">copy =</span> , <span class="dt">execute =</span> )
p<span class="op">$</span><span class="kw">memeber</span>(<span class="dt">usrname =</span> )<span class="op">$</span><span class="kw"><a href="../reference/delete-methods.html">delete</a></span>()

## file
### list all files in this project
p<span class="op">$</span><span class="kw">file</span>()
### list all public files
a<span class="op">$</span><span class="kw">file</span>(<span class="dt">visibility =</span> <span class="st">"public"</span>)
### copy
a<span class="op">$</span><span class="kw">copyFile</span>(<span class="kw">c</span>(fid, fid2), <span class="dt">project =</span> pid)
### delete
p<span class="op">$</span><span class="kw">file</span>(<span class="dt">id =</span> fid)<span class="op">$</span><span class="kw"><a href="../reference/delete-methods.html">delete</a></span>()
### download
p<span class="op">$</span><span class="kw">file</span>()[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">download_url</span>()
p<span class="op">$</span><span class="kw">file</span>(<span class="dt">id =</span> fid3)<span class="op">$</span><span class="kw"><a href="../reference/download-methods.html">download</a></span>(<span class="st">"~/Downloads/"</span>)
### download all
<span class="kw"><a href="../reference/download-methods.html">download</a></span>(p<span class="op">$</span><span class="kw">file</span>())
### update a file
fl<span class="op">$</span><span class="kw">update</span>(<span class="dt">name =</span> , <span class="dt">metadata =</span> <span class="kw">list</span>(<span class="dt">a =</span> , <span class="dt">b =</span> , ...))
### meta
fl<span class="op">$</span><span class="kw">meta</span>()
fl<span class="op">$</span><span class="kw">setMeta</span>()
fl<span class="op">$</span><span class="kw">setMeta</span>(..., <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)

## App
a<span class="op">$</span><span class="kw">app</span>()
### apps in a project
p<span class="op">$</span><span class="kw">app</span>()
p<span class="op">$</span><span class="kw">app</span>(name, id, <span class="dt">revision =</span> )
a<span class="op">$</span><span class="kw">copy_app</span>(aid, <span class="dt">project =</span> pid, <span class="dt">name =</span> )
### add
p<span class="op">$</span><span class="kw">app_add</span>(<span class="dt">short_name =</span> , <span class="dt">filename =</span>)

## Task
a<span class="op">$</span><span class="kw">task</span>()
a<span class="op">$</span><span class="kw">task</span>(<span class="dt">name =</span> , <span class="dt">id =</span> )
a<span class="op">$</span><span class="kw">task</span>(<span class="dt">status =</span> )

p<span class="op">$</span><span class="kw">task</span>()
p<span class="op">$</span><span class="kw">task</span>(<span class="dt">name =</span> , <span class="dt">id =</span> )
p<span class="op">$</span><span class="kw">task</span>(<span class="dt">status =</span> )

tsk &lt;-<span class="st"> </span>p<span class="op">$</span><span class="kw">task</span>(<span class="dt">name =</span> , <span class="dt">id =</span> )
tsk<span class="op">$</span><span class="kw">update</span>()
tsk<span class="op">$</span><span class="kw">abort</span>()
tsk<span class="op">$</span><span class="kw">run</span>()
tsk<span class="op">$</span><span class="kw"><a href="../reference/download-methods.html">download</a></span>()
tsk<span class="op">$</span><span class="kw">detele</span>()
tsk<span class="op">$</span><span class="kw">getInputs</span>()
tsk<span class="op">$</span><span class="kw">monitor</span>()

<span class="kw"><a href="../reference/TaskHook.html">getTaskHook</a></span>()
<span class="kw"><a href="../reference/TaskHook.html">setTaskHook</a></span>(<span class="dt">status =</span> , <span class="dt">fun =</span> )</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#introduction">Introduction</a><ul class="nav nav-pills nav-stacked">
<li><a href="#r-client-for-seven-bridges-api">R Client for Seven Bridges API</a></li>
      <li><a href="#api-general-information">API General Information</a></li>
      <li><a href="#installation">Installation</a></li>
      </ul>
</li>
      <li>
<a href="#quickstart">Quickstart</a><ul class="nav nav-pills nav-stacked">
<li><a href="#create-auth-object">Create <code>Auth</code> Object</a></li>
      <li><a href="#get-user-information">Get User Information</a></li>
      <li><a href="#rate-limit">Rate Limit</a></li>
      <li><a href="#show-billing-information">Show Billing Information</a></li>
      <li><a href="#create-project">Create Project</a></li>
      <li><a href="#get-details-about-existing-project">Get Details about Existing Project</a></li>
      <li><a href="#copy-public-apps-into-your-project">Copy Public Apps into Your Project</a></li>
      <li><a href="#import-cwl-app-and-run-a-task">Import CWL App and Run a Task</a></li>
      <li><a href="#execute-a-new-task">Execute a New Task</a></li>
      <li><a href="#run-a-task">Run a Task</a></li>
      <li><a href="#task-monitoring">Task Monitoring</a></li>
      </ul>
</li>
      <li>
<a href="#seven-bridges-api-reference">Seven Bridges API Reference</a><ul class="nav nav-pills nav-stacked">
<li><a href="#authentication">Authentication</a></li>
      <li><a href="#list-all-api-calls">List All API Calls</a></li>
      <li><a href="#offset-limit-search-and-advance-access-features">Offset, Limit, Search, and Advance Access Features</a></li>
      <li><a href="#query-parameter-fields">Query Parameter <code>'fields'</code></a></li>
      <li><a href="#rate-limits">Rate Limits</a></li>
      <li><a href="#users">Users</a></li>
      <li><a href="#billing-group-and-invoices">Billing Group and Invoices</a></li>
      <li><a href="#project">Project</a></li>
      <li><a href="#files-metadata-and-tags">Files, Metadata, and Tags</a></li>
      <li><a href="#app">App</a></li>
      <li><a href="#task">Task</a></li>
      <li><a href="#volumes">Volumes</a></li>
      <li><a href="#public-files-and-apps">Public Files and Apps</a></li>
      <li><a href="#get-raw-response-from-httr">Get Raw Response from httr</a></li>
      <li><a href="#batch-operation-on-projectfilestasks">Batch Operation on Project/Files/Tasks</a></li>
      </ul>
</li>
      <li><a href="#cheatsheet">Cheatsheet</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nan Xiao, Dusan Randjelovic, Tengfei Yin, Seven Bridges Genomics.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
